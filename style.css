/* フォント読み込み */
@import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@500;800&family=Yuji+Syuku&family=Shippori+Mincho:wght@800&family=RocknRoll+One&display=swap');

body {
    font-family: 'M PLUS Rounded 1c', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #4158D0, #C850C0, #FFCC70);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    color: #f0f0f0;
    margin: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    position: relative;
}
@keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

/* ===== 画面共通 ===== */
.screen {
    display: none;
    width: 100%;
    min-height: 100vh;
    box-sizing: border-box;
    position: relative;
    overflow: hidden;
    flex-grow: 1;
}
.screen.active {
    display: flex;
    animation: fadeIn 0.5s ease-out;
}
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* キラキラ背景 */
.stars, .twinkling { position:fixed; top:0; left:0; right:0; bottom:0; width:100%; height:100%; display:block; z-index: 0; }
.stars { background:#000 url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkAQMAAABKLAcXAAAABlBMVEVVVP////8vZtJdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAFUlEQVQ4y2NgoBpgImBqBNAyAMgwAAD70w43s4RL4wAAAABJRU5ErkJggg==) repeat top center; background-size: auto; opacity: 0.5; }
.twinkling{ background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIAQMAAACXljzdAAAABlBMVEVVVP////8vZtJdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAHUlEQVQ4y2NgoBpgImBqBNAyAMgwgM0IFJsKANqnHbcY5t6dAAAAAElFTkSuQmCC) repeat top center; background-size: auto; animation: move-twink-back 200s linear infinite; opacity: 0.3; }
@keyframes move-twink-back { from {background-position:0 0;} to {background-position:-10000px 5000px;} }

/* ===== タイトル & リザルト画面 & キャラクター選択画面 ===== */
#title-screen, #result-screen, #character-select-screen {
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    z-index: 1;
}
.title-content, .result-content, .character-select-content {
    background-color: rgba(30, 30, 50, 0.85);
    padding: 40px 60px;
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    z-index: 2;
    width: 90%;
    max-width: 800px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.game-title { background: linear-gradient(45deg, #ffeb3b, #ffcc70); -webkit-background-clip: text; background-clip: text; color: transparent; font-size: 4.2em; font-weight: 800; margin-bottom: 35px; text-shadow: 3px 3px 10px rgba(0,0,0,0.8); animation: pulse 2s infinite ease-in-out; font-family: 'Yuji Syuku', serif; }
@keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }

.mode-selector { margin-bottom: 30px; }
.mode-selector p { margin-bottom: 15px; font-size: 1.2em; color: #ddd; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
.mode-button { padding: 10px 22px; font-size: 1.1em; margin: 0 8px; cursor: pointer; border: none; border-radius: 20px; background-color: rgba(255, 255, 255, 0.1); color: #eee; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
.mode-button:hover { background-color: rgba(255, 255, 255, 0.2); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.4); }
.mode-button.selected { background: linear-gradient(45deg, #ffeb3b, #ffc107); color: #333; font-weight: bold; box-shadow: 0 4px 10px rgba(255, 200, 0, 0.5); }
.mode-button[data-mode="pvp"]:not(.selected) { background-color: rgba(150, 150, 150, 0.2); color: #aaa; cursor: not-allowed; }
.mode-button[data-mode="pvp"]:hover:not(.selected) { transform: none; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }

#start-game-button, #select-character-button { padding: 14px 35px; font-size: 1.4em; cursor: pointer; border: none; border-radius: 25px; color: white; font-weight: bold; transition: all 0.3s ease; text-shadow: 1px 1px 3px rgba(0,0,0,0.4); }
#start-game-button { background: linear-gradient(45deg, #C850C0, #ffcc70); box-shadow: 0 5px 15px rgba(200, 80, 192, 0.4); }
#start-game-button:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(200, 80, 192, 0.6); }
#select-character-button { padding: 10px 25px; font-size: 1.1em; background: linear-gradient(180deg, #8a94a8, #6c757d); box-shadow: 0 3px 7px rgba(108, 117, 125, 0.4); margin-top: 15px; }
#select-character-button:hover:not(:disabled) { background: linear-gradient(180deg, #9fa8b8, #7c858d); transform: translateY(-2px); box-shadow: 0 5px 10px rgba(108, 117, 125, 0.5); }
.button-pop { transition: transform 0.1s ease, box-shadow 0.2s ease; } .button-pop:active:not(:disabled) { transform: scale(0.95); }
.player-name-input-container { margin-top: 20px; }
.player-name-input-container label { margin-right: 8px; color: #ccc; }
#player-name-input { padding: 8px 12px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.2); background-color: rgba(255, 255, 255, 0.1); color: #fff; min-width: 200px; }
.title-extra-buttons { margin-top: 25px; display: flex; justify-content: center; gap: 10px; }


/* ===== ゲーム画面 ===== */
#game-screen { flex-direction: column; justify-content: flex-start; align-items: center; padding: 0; background-color: rgba(0, 0, 0, 0.2); z-index: 1; overflow: hidden; }
#game-screen.dimmed > *:not(#dice-roll-modal) { filter: blur(3px) brightness(0.6); pointer-events: none; transition: filter 0.3s ease-out; }

#game-header { position: fixed; top: 0; left: 0; width: 100%; background-color: rgba(30, 30, 50, 0.9); padding: 8px 15px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; z-index: 200; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); }
#game-main-area { display: flex; flex-direction: column; flex-grow: 1; width: 100%; overflow: hidden; padding-top: 50px; box-sizing: border-box; }
#game-scrollable-area { overflow-y: auto; flex-grow: 1; padding: 15px; padding-bottom: 150px; box-sizing: border-box; width: 100%; display: flex; flex-direction: column; }
#game-container { background-color: rgba(45, 45, 70, 0.8); padding: 25px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5); text-align: center; width: 100%; max-width: 80%; margin: 0 auto; display: flex; flex-direction: column; border: 1px solid rgba(255, 255, 255, 0.1); position: relative; flex-grow: 1; }
#game-coin-info { position: static; background: none; border: none; box-shadow: none; padding: 0; text-align: left; z-index: auto; }
#game-coin-info h3 { display: none; }
#game-coin-display { font-size: 1.2em; font-weight: bold; color: gold; text-shadow: 0 0 5px orange, 0 0 8px gold, 1px 1px 2px rgba(0,0,0,0.7); animation: coinShine 2.5s infinite linear; margin: 0; }
@keyframes coinShine { 0%, 100% { opacity: 0.8; text-shadow: 0 0 5px orange, 0 0 8px gold, 1px 1px 2px rgba(0,0,0,0.7); } 50% { opacity: 1; text-shadow: 0 0 8px orange, 0 0 15px gold, 1px 1px 2px rgba(0,0,0,0.7); } }
#settings-button-container { position: static; }
#settings-button { padding: 5px 10px; font-size: 1.5em; line-height: 1; background: rgba(255, 255, 255, 0.1); color: #eee; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 50%; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; }
#settings-button:hover:not(:disabled) { background: rgba(255, 255, 255, 0.2); color: #fff; transform: translateY(-1px); box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
#game-container > div:nth-child(1) { margin-bottom: 5px; }
#wave-info { font-size: 1.1em; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); text-align: center; margin-top: 0; margin-bottom: 10px; }
.wave-highlight { color: #ffcc70; font-weight: bold; }
.round-normal { color: #ccc; font-weight: normal; }
#consecutive-wins-display { font-weight: bold; margin-left: 10px; font-size: 0.9em; }
#consecutive-wins-display:not(.npc-losing-streak) { color: #ffeb3b; animation: pulseYellow 1.5s infinite ease-in-out; }
#consecutive-wins-display.npc-losing-streak { color: #add8e6; animation: pulseBlue 1.8s infinite ease-in-out; font-style: italic; }
@keyframes pulseYellow { 0%, 100% { opacity: 1; text-shadow: 0 0 5px #ffeb3b; } 50% { opacity: 0.7; text-shadow: none; } }
@keyframes pulseBlue { 0%, 100% { opacity: 1; text-shadow: 0 0 5px #6495ED; } 50% { opacity: 0.6; text-shadow: none; } }
/* 依頼6: アナウンス欄演出 (修正版) */
#current-bet-info {
    background-color: rgba(0, 0, 0, 0.3);
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 1.1em;
    border: 2px solid #ffeb3b; /* ★ 枠線を直接指定 */
    position: relative;
    overflow: hidden;
    min-height: 1.5em;
    margin-bottom: 15px;
    font-weight: bold;
    color: #ffeb3b; /* ネオンイエローテキスト */
    text-shadow: 0 0 3px #fff, 0 0 5px #ffeb3b, 0 0 7px #ffc107, 1px 1px 2px rgba(0,0,0,0.6);
    animation: neonPulseYellow 1.8s infinite ease-in-out; /* ★ パルスアニメーション */
    box-shadow: 0 0 5px #ffeb3b, inset 0 0 5px #ffeb3b, 0 0 10px rgba(0,0,0,0.4);
}
#current-bet-info .parent-name {
    font-weight: normal;
    color: #ffffff; /* ネオンホワイトテキスト */
    text-shadow: 0 0 3px #eee, 0 0 5px #fff, 1px 1px 2px rgba(0,0,0,0.6);
}
@keyframes neonPulseYellow {
  0%, 100% {
    border-color: #ffeb3b;
    box-shadow: 0 0 5px #ffeb3b, inset 0 0 5px #ffeb3b, 0 0 10px rgba(0,0,0,0.4);
    text-shadow: 0 0 3px #fff, 0 0 5px #ffeb3b, 0 0 7px #ffc107, 1px 1px 2px rgba(0,0,0,0.6);
  }
  50% {
    border-color: #fff06b;
    box-shadow: 0 0 10px #ffeb3b, inset 0 0 10px #ffeb3b, 0 0 15px rgba(255, 235, 59, 0.5), 0 0 10px rgba(0,0,0,0.4);
    text-shadow: 0 0 5px #fff, 0 0 8px #ffeb3b, 0 0 12px #ffc107, 1px 1px 2px rgba(0,0,0,0.6);
  }
}
#message-area {
    background-color: rgba(30, 30, 50, 0.75);
    padding: 12px;
    margin-bottom: 0;
    border-radius: 8px;
    min-height: 3em;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border: 2px solid #90ee90; /* ★ 枠線を直接指定 */
    text-align: center;
    position: relative;
    overflow: hidden;
    animation: neonPulseGreen 1.8s infinite ease-in-out 0.2s; /* ★ パルスアニメーション */
    box-shadow: 0 0 5px #90ee90, inset 0 0 5px #90ee90, 0 0 10px rgba(0,0,0,0.4);
}
#message {
    margin: 0;
    font-style: italic;
    font-size: 1.1em;
    font-weight: 500;
    margin-bottom: 8px;
    color: #90ee90; /* ネオングリーンテキスト */
    text-shadow: 0 0 3px #fff, 0 0 5px #90ee90, 0 0 7px #28a745, 1px 1px 2px rgba(0,0,0,0.6);
}
@keyframes neonPulseGreen {
  0%, 100% {
    border-color: #90ee90;
    box-shadow: 0 0 5px #90ee90, inset 0 0 5px #90ee90, 0 0 10px rgba(0,0,0,0.4);
  }
  50% {
    border-color: #a0f0a0;
    box-shadow: 0 0 10px #90ee90, inset 0 0 10px #90ee90, 0 0 15px rgba(144, 238, 144, 0.5), 0 0 10px rgba(0,0,0,0.4);
  }
}
#game-area { display: flex; justify-content: space-between; align-items: stretch; margin-bottom: 25px; gap: 15px; flex-grow: 1; }
.player-box { background-color: rgba(60, 60, 90, 0.85); padding: 18px; border-radius: 10px; width: 250px; box-sizing: border-box; display: flex; flex-direction: column; border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: inset 0 0 10px rgba(0,0,0,0.3); position: relative; }
.player-box h2 { margin-top: 0; margin-bottom: 12px; color: #eee; font-size: 1.3em; border-bottom: 1px solid rgba(255, 255, 255, 0.2); padding-bottom: 8px; font-weight: 500; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
.parent-marker { color: #ffeb3b; font-size: 0.8em; margin-left: 5px; vertical-align: middle; font-weight: bold; display: none; text-shadow: 0 0 3px #ffc107; }
.player-box p { margin: 10px 0; font-size: 1em; color: #ddd; } .player-box span { font-weight: bold; }
.score-container { position: relative; } .score { color: #ffeb3b; font-size: 1.1em; }
#player-dice, #npc-dice { font-family: monospace; font-size: 1.2em; color: #fff; }
.hand-display { color: #ffcc70; font-weight: 800; display: inline-block; transition: transform 0.3s ease, color 0.3s ease; text-shadow: 1px 1px 4px rgba(0,0,0,0.6); }
.hand-display.highlight { animation: handHighlight 0.8s ease-out forwards; }
.hand-display.highlight.hifumi { animation: handHighlightHifumi 1s ease-in-out forwards; }
.hand-display.highlight.strong { animation: handHighlightStrong 1.2s ease-out forwards; }
.hand-display.highlight.legendary { animation: handHighlightLegendary 1.5s ease-out forwards; }
@keyframes handHighlight { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.3); color: #ffeb3b; } 100% { transform: scale(1); } }
@keyframes handHighlightHifumi { 0% { transform: scale(1) rotate(0deg); color: #ffcc70; filter: grayscale(0) brightness(1); } 30% { transform: scale(0.9) rotate(3deg); color: #add8e6; filter: grayscale(0.6) brightness(0.9); } 70% { transform: scale(0.95) rotate(-3deg); } 100% { transform: scale(1) rotate(0deg); color: #ffcc70; filter: grayscale(0) brightness(1); } }
@keyframes handHighlightStrong { 0% { transform: scale(1) rotate(0deg); text-shadow: 1px 1px 4px rgba(0,0,0,0.6); filter: brightness(1); } 25% { transform: scale(1.5) rotate(-5deg); color: #ffeb3b; text-shadow: 0 0 12px #ffc107; filter: brightness(1.2); } 50% { filter: brightness(1.4); transform: scale(1.45); } 75% { transform: scale(1.4) rotate(5deg); filter: brightness(1.3); } 100% { transform: scale(1) rotate(0deg); text-shadow: 1px 1px 4px rgba(0,0,0,0.6); filter: brightness(1); } }
@keyframes handHighlightLegendary { 0% { transform: scale(1); filter: brightness(1) drop-shadow(0 0 0px gold); } 15% { transform: scale(1.8) rotate(-7deg); filter: brightness(2.5) drop-shadow(0 0 20px gold); color: gold; } 30% { transform: scale(1.7) rotate(7deg); filter: brightness(1.8) drop-shadow(0 0 30px gold); } 45% { transform: scale(1.75) rotate(-5deg); filter: brightness(2.2) drop-shadow(0 0 25px gold); } 60% { transform: scale(1.7) rotate(5deg); filter: brightness(2.0) drop-shadow(0 0 22px gold); } 100% { transform: scale(1); filter: brightness(1) drop-shadow(0 0 0px gold); } }
#dice-area { flex-grow: 1; text-align: center; padding: 25px; background-color: rgba(70, 70, 100, 0.85); border-radius: 12px; display: flex; flex-direction: column; justify-content: center; align-items: center; border: 3px solid rgba(255, 255, 255, 0.2); overflow: visible; box-shadow: inset 0 0 15px rgba(0,0,0,0.4); position: relative; width: auto; max-width: 380px; margin: 0 auto; }
#dice-display { font-size: 5em; font-weight: 800; margin: 15px 0; color: #ffffff; min-height: 1.2em; letter-spacing: 0.15em; font-family: 'M PLUS Rounded 1c', sans-serif; text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.6); white-space: nowrap; transition: transform 0.1s ease-out, display 0s; display: block; }
#dice-display .dice-num { display: inline-block; margin: 0 0.05em; }
#dice-display.rolling .dice-num { color: #bbb; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4); }
#dice-display.settled .dice-num { animation: diceSettle 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes diceSettle { 0% { transform: scale(1.1) rotate(-2deg); } 60% { transform: scale(0.97) rotate(2deg); } 100% { transform: scale(1); } }
.roll-counter-top-right { position: absolute; top: 10px; right: 15px; font-size: 0.9em; color: rgba(255, 255, 255, 0.6); background-color: rgba(0, 0, 0, 0.3); padding: 2px 6px; border-radius: 4px; z-index: 5; }
.character-image-area {
    width: 250px;
    height: 300px;
    border-radius: 12px; /* ★ 角を少し丸くする */
    display: flex;
    justify-content: center;
    align-items: center;
    color: #aaa;
    font-size: 0.9em;
    text-align: center;
    align-self: center;
    flex-shrink: 0;
    overflow: hidden; /* 疑似要素がはみ出ないように */
    position: relative; /* ★ 疑似要素の基準位置 */
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5); /* ★ 内側の影を追加 */
    background: rgba(20, 20, 40, 0.7); /* ★ 暗めの背景色 */
}
.character-image-area::before {
    content: '';
    position: absolute;
    top: -3px; left: -3px; right: -3px; bottom: -3px; /* 枠線の太さに合わせて調整 */
    border-radius: 14px; /* 親要素より少し大きい角丸 */
    z-index: -1; /* 画像の後ろに配置 */
    background: conic-gradient(
        from var(--angle, 0deg),
        transparent 0%,
        transparent 40%, /* 光らない部分 */
        var(--neon-color-light) 50%, /* 光の中心 */
        transparent 60%, /* 光らない部分 */
        transparent 100%
    );
    animation: rotateNeonBorder 4s linear infinite;
    filter: blur(3px); /* 光をぼかす */
    opacity: 0.8; /* 少し透明度を下げる */
}
.character-image-area.player {
    /* ★ 青系の色をカスタムプロパティで定義 */
    --neon-color: #0af; /* 明るい青 */
    --neon-color-light: #6cf; /* さらに明るい青 */
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5), 0 0 8px rgba(0, 170, 255, 0.5); /* 外側の光を追加 */
}
.character-image-area.player::before {
    /* ★ 青系の色を使用 */
     background: conic-gradient(
        from var(--angle, 0deg),
        transparent 0%, transparent 40%,
        var(--neon-color-light) 50%, /* 明るい青 */
        transparent 60%, transparent 100%
    );
}
.character-image-area.npc {
    /* ★ 赤系の色をカスタムプロパティで定義 */
    --neon-color: #f44; /* 明るい赤 */
    --neon-color-light: #f88; /* さらに明るい赤 */
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5), 0 0 8px rgba(255, 68, 68, 0.5); /* 外側の光を追加 */
}
.character-image-area.npc::before {
     /* ★ 赤系の色を使用 */
     background: conic-gradient(
        from var(--angle, 0deg),
        transparent 0%, transparent 40%,
        var(--neon-color-light) 50%, /* 明るい赤 */
        transparent 60%, transparent 100%
    );
}
@keyframes rotateNeonBorder {
    from {
        --angle: 0deg;
    }
    to {
        --angle: 360deg;
    }
}
.character-image-area img {
    max-width: 100%;
    max-height: 100%;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px; /* ★ 内側の画像の角丸 */
    display: block;
    position: relative; /* ★ z-index を有効にするため */
    z-index: 1; /* ★ ネオンラインより手前に */
}
.character-image-area.npc img { transform: scaleX(-1); }
#message-button-container { display: flex; gap: 10px; margin-top: 8px; }
#bottom-spacer { height: 150px; flex-shrink: 0; }
#bottom-control-bar { position: fixed; bottom: 0; left: 0; width: 100%; background-color: rgba(30, 30, 50, 0.95); padding: 10px 15px 15px 15px; border-top: 1px solid rgba(255, 255, 255, 0.15); box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.4); z-index: 100; box-sizing: border-box; }
.center-role { position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%); font-size: 6em; font-weight: 800; color: white; text-shadow: 3px 3px 0 #444, 6px 6px 10px rgba(0, 0, 0, 0.7); opacity: 0; pointer-events: none; z-index: 20; white-space: nowrap; padding: 0.1em 0.5em; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); width: auto; max-width: 90%; text-align: center; background-color: transparent; }
.center-role.role-appear { animation: centerRoleAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards, centerRoleFadeOut 0.5s ease-out forwards var(--center-role-duration, 2s); }
@keyframes centerRoleAppear { 0% { transform: translate(-50%, -50%) scale(0.5) rotate(-5deg); opacity: 0; } 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; } }
@keyframes centerRoleFadeOut { 0% { opacity: 1; } 100% { opacity: 0; } }
.center-role.role-pinzoro { font-family: 'Shippori Mincho', serif; font-size: 8em; color: gold; text-shadow: 0 0 10px white, 0 0 20px gold, 3px 3px 5px rgba(0,0,0,0.6); filter: drop-shadow(0 0 10px gold); animation-name: centerRolePinzoro, centerRoleFadeOut; animation-duration: 0.6s, 0.5s; animation-timing-function: cubic-bezier(0.68, -0.6, 0.27, 1.55), ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, 2.5s; padding: 0.2em 0.6em; }
@keyframes centerRolePinzoro { 0% { transform: translate(-50%, -50%) scale(3) rotateY(180deg); opacity: 0; } 100% { transform: translate(-50%, -50%) scale(1) rotateY(0deg); opacity: 1; } }
.center-role.role-arashi { font-family: 'RocknRoll One', sans-serif; font-size: 7.5em; color: #ffcc80; text-shadow: 0 0 8px #ff5722, 3px 3px 6px rgba(0, 0, 0, 0.7); animation-name: centerRoleArashi, centerRoleFadeOut; animation-duration: 0.5s, 0.5s; animation-timing-function: cubic-bezier(0.68, -0.6, 0.27, 1.55), ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, 2.2s; padding: 0.15em 0.5em; background-color: rgba(80, 20, 0, 0.8); }
@keyframes centerRoleArashi { 0% { transform: translate(-50%, -50%) scale(0) rotate(720deg); opacity: 0; filter: blur(8px); } 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; filter: blur(0px); } }
.center-role.role-shigoro { font-family: 'Yuji Syuku', serif; font-size: 7em; color: #ffe082; text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 5px #ff9800; --center-role-duration: 2s; padding: 0.1em 0.4em; background-color: rgba(80, 50, 0, 0.8); }
.center-role.role-normal-eye { font-family: 'M PLUS Rounded 1c', sans-serif; font-size: 6em; color: #eee; text-shadow: 2px 2px 5px rgba(0,0,0,0.5); --center-role-duration: 1.5s; background-color: rgba(40, 40, 80, 0.7); }
.center-role.role-hifumi { font-family: 'Yuji Syuku', serif; font-size: 6.5em; color: #cdeaff; text-shadow: 1px 1px 4px rgba(0,0,0,0.7), 0 0 5px #5882b4; animation-name: centerRoleHifumi, centerRoleFadeOut; animation-duration: 0.8s, 0.5s; animation-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1), ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, 1.8s; background-color: rgba(30, 40, 70, 0.8); }
@keyframes centerRoleHifumi { 0% { transform: translate(-50%, -50%) translateY(30px) rotate(-15deg); opacity: 0; } 100% { transform: translate(-50%, -50%) translateY(0) rotate(0deg); opacity: 1; } }
.center-role.role-shonben { font-family: 'M PLUS Rounded 1c', sans-serif; font-size: 4.8em; color: #bbb; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); --center-role-duration: 1.5s; background-color: transparent; }
.center-role.result-win { font-family: 'RocknRoll One', sans-serif; font-size: 7em; color: #ffeb3b; text-shadow: 0 0 8px white, 0 0 15px #ffc107, 3px 3px 6px rgba(0,0,0,0.6); animation-name: resultWinAppear, centerRoleFadeOut; animation-duration: 0.7s, 0.5s; animation-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1), ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, var(--center-role-duration, 1.8s); padding: 0.2em 0.6em; }
@keyframes resultWinAppear { 0% { transform: translate(-50%, -50%) scale(0.2) rotate(-30deg); opacity: 0; filter: blur(5px); } 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; filter: blur(0px); } }
.center-role.result-lose { font-family: 'Yuji Syuku', serif; font-size: 6.5em; color: #add8e6; text-shadow: 0 0 6px #4682B4, 2px 2px 4px rgba(0,0,0,0.7); animation-name: resultLoseAppear, centerRoleFadeOut; animation-duration: 0.9s, 0.5s; animation-timing-function: ease-out, ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, var(--center-role-duration, 1.8s); padding: 0.15em 0.5em; }
@keyframes resultLoseAppear { 0% { transform: translate(-50%, -80%) scale(1.1); opacity: 0; } 50% { transform: translate(-50%, -45%); opacity: 0.8; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
.center-role.result-wave-clear { font-family: 'Shippori Mincho', serif; font-size: 8em; color: #90ee90; background: linear-gradient(45deg, #90ee90, #32cd32); -webkit-background-clip: text; background-clip: text; color: transparent; text-shadow: 0 0 15px white, 0 0 25px #90ee90, 4px 4px 8px rgba(0,0,0,0.6); filter: drop-shadow(0 0 15px #90ee90); animation-name: waveClearAppear, centerRoleFadeOut; animation-duration: 1.2s, 0.5s; animation-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275), ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, var(--center-role-duration, 2.5s); padding: 0.3em 0.7em; background-color: transparent; }
@keyframes waveClearAppear { 0% { transform: translate(-50%, -50%) scale(0.5) rotateY(-180deg); opacity: 0; } 100% { transform: translate(-50%, -50%) scale(1) rotateY(0deg); opacity: 1; } }
.center-role.result-game-over { font-family: 'Yuji Syuku', serif; font-size: 7.5em; color: #ff7b7b; text-shadow: 0 0 10px #dc143c, 3px 3px 6px rgba(0,0,0,0.8); animation-name: gameOverAppear, centerRoleFadeOut; animation-duration: 1.5s, 0.5s; animation-timing-function: ease-in-out, ease-out; animation-fill-mode: forwards, forwards; animation-delay: 0s, var(--center-role-duration, 2.5s); padding: 0.2em 0.6em; background-color: transparent; }
@keyframes gameOverAppear { 0% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; filter: grayscale(100%); } 50% { transform: translate(-50%, -50%) scale(0.9); opacity: 1; filter: grayscale(50%); } 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; filter: grayscale(0); } }
#control-area { display: flex; flex-direction: column; align-items: stretch; gap: 10px; margin-top: 0; max-width: 60%; margin: 0 auto; }
.bet-main-controls { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; background-color: rgba(0,0,0,0.25); padding: 10px; border-radius: 10px; box-sizing: border-box; transition: opacity 0.3s ease; }
.bet-adjust-container { display: flex; gap: 5px; }
.bet-input-container { display: flex; flex-direction: column; align-items: center; gap: 2px; min-width: 120px; }
.bet-input-container label { font-size: 0.9em; color: #ccc; white-space: nowrap; }
#bet-input { padding: 10px; font-size: 1.2em; width: 100%; max-width: 100px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; background-color: rgba(255, 255, 255, 0.1); color: #fff; text-align: center; box-shadow: inset 0 2px 4px rgba(0,0,0,0.3); box-sizing: border-box; }
#min-bet-display { margin-left: 0; color: #ffcc70; font-size: 0.85em; font-weight: bold; align-self: center; white-space: nowrap; margin-top: 3px; }
.bet-action-container { display: flex; gap: 10px; align-items: stretch; justify-content: center; background-color: rgba(0,0,0,0.25); padding: 8px; border-radius: 10px; transition: opacity 0.3s ease, display 0.3s ease; }
.bet-action-container button { flex-grow: 1; padding: 10px 15px; }
#action-controls { display: flex; justify-content: center; gap: 10px; align-items: stretch; }
#action-controls button { flex-grow: 1; }
.bet-adjust-button { padding: 8px 14px; font-size: 1.1em; min-width: 55px; border-radius: 18px; color: white; font-weight: bold; transition: transform 0.1s ease, box-shadow 0.2s ease, background 0.2s ease; box-shadow: 0 3px 6px rgba(0,0,0,0.3); }
.bet-adjust-button.plus { background: linear-gradient(180deg, #5cb85c, #4cae4c); }
.bet-adjust-button.plus:hover:not(:disabled) { background: linear-gradient(180deg, #6cd96c, #5bc85b); }
.bet-adjust-button.minus { background: linear-gradient(180deg, #d9534f, #c9302c); }
.bet-adjust-button.minus:hover:not(:disabled) { background: linear-gradient(180deg, #e06b67, #d6403b); }
/* 依頼3: MIN/MAXボタン色変更 */
#min-bet-button {
    background: linear-gradient(180deg, #f0ad4e, #ec971f); /* オレンジ系 */
    color: white;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
}
#min-bet-button:hover:not(:disabled) {
    background: linear-gradient(180deg, #f3bc70, #f0a540);
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(236, 151, 31, 0.4);
}
#set-bet-button {
    background: linear-gradient(180deg, #ffeb3b, #ffc107);
    color: #fff; /* ★ テキスト色 白に変更 */
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4); /* ★ 影を調整 */
}
#set-bet-button:hover:not(:disabled) { background: linear-gradient(180deg, #fff06b, #ffd24d); transform: translateY(-2px); box-shadow: 0 5px 10px rgba(255, 200, 0, 0.4); }
#max-bet-button {
    background: linear-gradient(180deg, #90ee90, #28a745); /* 黄緑系 */
    color: #fff; 
    text-shadow: 0px 1px 1px rgba(0,0,0,0.4); /* ★ 影を調整 */
}
#max-bet-button:hover:not(:disabled) {
    background: linear-gradient(180deg, #a0f0a0, #30c050);
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(40, 167, 69, 0.4);
}
#bet-input:focus { background-color: rgba(255, 255, 255, 0.2); outline: 2px solid #ffeb3b; }
#bet-input:disabled { background-color: rgba(80, 80, 80, 0.5); color: #aaa; cursor: not-allowed; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4); }
#game-screen.npc-parent .bet-main-controls { opacity: 0.5; pointer-events: none; }
#game-screen.npc-parent .bet-action-container { display: none; }
#game-screen.npc-parent .bet-input-container label, #game-screen.npc-parent .bet-input-container span { opacity: 0.7; }
#game-screen.npc-parent #bet-input { background-color: rgba(50, 50, 70, 0.7); border: 1px solid rgba(255, 255, 255, 0.1); pointer-events: none; }
#next-wave-area { display: none; justify-content: center;  margin-top: 10px; }
button { padding: 10px 18px; font-size: 1em; cursor: pointer; border: none; border-radius: 20px; color: #333; font-weight: bold; transition: all 0.2s ease; text-shadow: 0px 1px 1px rgba(255,255,255,0.3); box-shadow: 0 3px 5px rgba(0,0,0,0.3); }
button:disabled {
    background-color: #555 !important; /* !importantで確実に上書き */
    background-image: none !important;
    color: #999 !important;
    cursor: not-allowed;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);
    text-shadow: none;
    transform: none !important; /* ホバーなどの変形も無効化 */
    animation: none !important; /* アニメーションも停止 */
    border: none !important; /* 枠線もリセット */
}
/* ショップの購入/強化ボタンにも適用 */
.buy-button:disabled, .upgrade-button:disabled {
    background-color: #555 !important;
    background-image: none !important;
    color: #999 !important;
    cursor: not-allowed;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);
    text-shadow: none;
    transform: none !important;
}
#roll-button {
    background: linear-gradient(180deg, #ffeb3b, #ffc107);
    color: #fff; /* ★ テキスト色 白に変更 */
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4); /* ★ 影を調整 */
}
#roll-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 10px rgba(255, 200, 0, 0.4); }
/* ロールボタンアニメーション */
#roll-button:not(:disabled) {
    animation: rollButtonPulse 1.5s infinite ease-in-out;
    box-shadow: 0 0 12px 2px gold, 0 3px 5px rgba(0,0,0,0.3); /* 黄色系の影 */
    border: 1px solid gold;
}
@keyframes rollButtonPulse {
    0%, 100% { transform: scale(1); box-shadow: 0 0 12px 2px gold, 0 3px 5px rgba(0,0,0,0.3); }
    50% { transform: scale(1.05); box-shadow: 0 0 20px 5px gold, 0 3px 5px rgba(0,0,0,0.3); }
}
#next-wave-button {
    background: linear-gradient(180deg, #ffeb3b, #ffc107); /* 背景色は維持 */
    padding: 12px 30px; /* ★ パディングを少し増やす */
    font-size: 1.2em; /* ★ フォントサイズを少し大きく */
    color: #fff; /* ★ テキスト色を白に */
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* ★ 白文字に合うように影調整 */
    /* ★ ハイライト用スタイル追加 */
    border: 1px solid gold;
    box-shadow: 0 0 12px 2px gold, 0 3px 5px rgba(0,0,0,0.3);
    animation: nextWavePulse 1.5s infinite ease-in-out;
}
#restart-same-mode-button, #confirm-character-yes { background: linear-gradient(180deg, #ffeb3b, #ffc107); }
#next-wave-button:hover:not(:disabled) { /* ホバー効果も少し調整 */
    transform: translateY(-2px) scale(1.02); /* 少し拡大 */
    box-shadow: 0 0 18px 4px gold, 0 5px 10px rgba(255, 200, 0, 0.4);
}
@keyframes nextWavePulse {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 0 12px 2px gold, 0 3px 5px rgba(0,0,0,0.3);
    }
    50% {
        transform: scale(1.03); /* 少しだけ拡大 */
        box-shadow: 0 0 18px 4px gold, 0 3px 5px rgba(0,0,0,0.3);
    }
}
#restart-same-mode-button:hover, #confirm-character-yes:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 10px rgba(255, 200, 0, 0.4); }
#history-button {
    background: linear-gradient(180deg, #5bc0de, #31b0d5); /* 青緑系 */
    color: white;
    text-shadow: 0px -1px 1px rgba(0,0,0,0.4);
}
#history-button:hover:not(:disabled) {
    background: linear-gradient(180deg, #70cce6, #4ac0e0);
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(49, 176, 213, 0.4);
}
#card-action-button, /* 通常カードボタン */
#post-roll-card-button /* アナウンス欄カードボタン */ {
    background: linear-gradient(180deg, #5bc0de, #31b0d5);
    color: white; /* ★ テキスト色 白 */
    text-shadow: 0px -1px 1px rgba(0,0,0,0.4);
    position: relative;
    overflow: hidden;
}
#card-action-button:hover:not(:disabled),
#post-roll-card-button:hover:not(:disabled) {
    background: linear-gradient(180deg, #70cce6, #4ac0e0);
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(49, 176, 213, 0.4);
}
/* カードボタンハイライト */
#card-action-button.highlight-card-button,
#post-roll-card-button.highlight-card-button { /* メッセージエリア内ボタンも */
    animation: cardButtonPulse 1.5s infinite ease-in-out;
    box-shadow: 0 0 12px 2px #00ffff, 0 3px 5px rgba(0,0,0,0.3);
    border: 1px solid #00ffff;
}
@keyframes cardButtonPulse {
    0%, 100% { transform: scale(1); box-shadow: 0 0 12px 2px #00ffff, 0 3px 5px rgba(0,0,0,0.3); }
    50% { transform: scale(1.05); box-shadow: 0 0 20px 5px #00ffff, 0 3px 5px rgba(0,0,0,0.3); }
}
#card-action-button.highlight-card-button::before,
#post-roll-card-button.highlight-card-button::before {
    content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
    background: radial-gradient(circle, rgba(0, 255, 255, 0.3) 0%, rgba(0, 255, 255, 0) 70%);
    animation: cardButtonShine 3s infinite linear; pointer-events: none;
}
@keyframes cardButtonShine { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.button-subtle, #back-to-title-from-result-button, /*#history-button,*/ #settings-button, #back-to-title-button, #confirm-character-no { background: linear-gradient(180deg, #8a94a8, #6c757d); color: white; text-shadow: 0px -1px 1px rgba(0,0,0,0.4); }
.button-subtle:hover:not(:disabled), #back-to-title-from-result-button:hover, /*#history-button:hover:not(:disabled),*/ #settings-button:hover:not(:disabled), #back-to-title-button:hover:not(:disabled), #confirm-character-no:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 10px rgba(108, 117, 125, 0.4); }
.temp-choice-button { margin: 0 5px; padding: 8px 16px; font-size: 0.95em; }
.skip-button {
    background: linear-gradient(180deg, #f0ad4e, #ec971f); /* オレンジ系 */
    color: white; /* テキスト白 */
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4); /* 影 */
}
.skip-button:hover:not(:disabled) {
    background: linear-gradient(180deg, #f3bc70, #f0a540);
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(236, 151, 31, 0.4);
}
.score-change-popup { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 1.3em; font-weight: bold; padding: 2px 8px; border-radius: 5px; z-index: 10; pointer-events: none; opacity: 0; white-space: nowrap; animation: scorePopup 1.5s ease-out forwards; }
.score-change-popup.gain { color: #fff; background-color: rgba(40, 167, 69, 0.9); text-shadow: 0 0 3px #000; }
.score-change-popup.loss { color: #fff; background-color: rgba(220, 53, 69, 0.9); text-shadow: 0 0 3px #000; }
@keyframes scorePopup { 0% { transform: translate(-50%, 0) scale(0.8); opacity: 1; } 80% { transform: translate(-50%, -35px) scale(1.1); opacity: 1; } 100% { transform: translate(-50%, -45px) scale(1); opacity: 0; } }

/* リザルト画面 */
.result-content { background-color: rgba(30, 30, 50, 0.9); min-width: 400px; }
#result-title { font-size: 3em; margin-bottom: 20px; font-weight: 800; text-shadow: 2px 2px 6px rgba(0,0,0,0.6); } #result-title.clear { color: #90ee90; } #result-title.over { color: #ff7b7b; }
#result-message, #final-score { font-size: 1.3em; margin-bottom: 15px; color: #ddd; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); } #final-score { font-weight: bold; color: #ffeb3b; }
.result-actions { margin-top: 30px; display: flex; justify-content: space-around; gap: 15px; }
#restart-same-mode-button { background: linear-gradient(180deg, #90ee90, #28a745); color: #333; }
#restart-same-mode-button:hover { transform: translateY(-2px); box-shadow: 0 5px 10px rgba(40, 167, 69, 0.4); }

/* ===== キャラクター選択画面 ===== */
#character-select-screen h2 { color: #ffcc70; margin-bottom: 25px; font-size: 2.5em; font-family: 'Yuji Syuku', serif; margin-top: 0; }
.character-select-body { display: flex; width: 100%; gap: 20px; margin-bottom: 25px; min-height: 400px; }
#character-list { flex: 1; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; max-height: 60vh; overflow-y: auto; border: 1px solid rgba(255, 255, 255, 0.1); display: flex; flex-direction: column; gap: 8px; }
#character-list p { color: #aaa; text-align: center; margin-top: 10px; font-style: italic; }
#character-list button { width: 100%; padding: 10px; font-size: 1.1em; background-color: rgba(255, 255, 255, 0.08); color: #eee; border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 5px; text-align: left; cursor: pointer; transition: background-color 0.2s ease, border-color 0.2s ease; box-shadow: none; text-shadow: none; font-weight: normal; }
#character-list button:hover { background-color: rgba(255, 255, 255, 0.15); border-color: rgba(255, 255, 255, 0.3); }
#character-list button.selected { background-color: rgba(255, 235, 59, 0.3); border-color: #ffeb3b; color: #fff; font-weight: bold; }
#character-preview { flex: 1.5; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 8px; text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; border: 1px solid rgba(255, 255, 255, 0.1); min-height: 300px; }
#character-preview-placeholder { color: #aaa; font-size: 1.2em; font-style: italic; }
#character-preview-image { max-width: 100%; max-height: 350px; object-fit: contain; margin-bottom: 20px; display: none; border-radius: 5px; background-color: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); }
#character-confirm-area { display: none; margin-top: 15px; }
#character-confirm-message { color: #eee; margin-bottom: 15px; font-size: 1.1em; }
#character-confirm-area button { margin: 0 10px; padding: 10px 25px; }
#back-to-title-button { margin-top: 20px; padding: 10px 30px; }

/* ===== モーダル共通 ===== */
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.8); justify-content: center; align-items: center; backdrop-filter: blur(5px); animation: modalFadeIn 0.3s ease-out; }
@keyframes modalFadeIn { from { opacity: 0; } to { opacity: 1; } }
.modal-content { background-color: #2a2a3a; margin: auto; padding: 30px; border: 1px solid rgba(255, 255, 255, 0.1); width: 85%; max-width: 650px; border-radius: 15px; position: relative; box-shadow: 0 8px 25px rgba(0,0,0,0.6); animation: slideDown 0.4s ease-out; }
@keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
.close-button { color: #aaa; position: absolute; top: 15px; right: 25px; font-size: 32px; font-weight: bold; cursor: pointer; transition: color 0.2s ease; z-index: 1; }
.close-button:hover, .close-button:focus { color: #fff; }
.modal h2 { margin-top: 0; color: #ffcc70; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.2); padding-bottom: 10px; font-weight: 500; text-shadow: 1px 1px 3px rgba(0,0,0,0.5);}
#history-log { list-style: none; padding: 0; max-height: 65vh; overflow-y: auto; margin-top: 20px; }
#history-log li { background-color: rgba(70, 70, 100, 0.6); margin-bottom: 10px; padding: 12px 18px; border-radius: 8px; border-left: 6px solid #666; font-size: 0.95em; transition: background-color 0.2s ease; }
#history-log li:hover { background-color: rgba(85, 85, 115, 0.7); }
#history-log li.win { border-left-color: #90ee90; } #history-log li.lose { border-left-color: #ff7b7b; } #history-log li.draw { border-left-color: #aaa; }
#history-log .wave-num { font-weight: normal; color: #ccc; display: block; margin-bottom: 6px; }
#history-log .wave-highlight { color: #ffcc70; font-weight: bold; }
#history-log .round-normal { color: #ccc; font-weight: normal; }
.history-result { font-weight: bold; margin-right: 5px; display: inline-block; min-width: 50px; text-align: center; padding: 2px 4px; border-radius: 4px; }
.history-result.history-win { color: #111; background-color: #90ee90; box-shadow: inset 0 0 3px rgba(0,0,0,0.3); text-shadow: 0 1px 1px rgba(255,255,255,0.5); }
.history-result.history-lose { color: #eee; background-color: #ff7b7b; box-shadow: inset 0 0 3px rgba(0,0,0,0.4); text-shadow: 0 -1px 1px rgba(0,0,0,0.4); }
.history-result.history-draw { color: #ddd; background-color: #aaa; box-shadow: inset 0 0 3px rgba(0,0,0,0.2); }
#history-log .details { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 5px;} #history-log .player, #history-log .npc { font-family: monospace; color: #eee; } #history-log .vs { margin: 0 10px; font-weight: bold; color: #ccc; } #history-log .hand { font-size: 0.9em; color: #bbb; margin-left: 5px; font-style: italic;}
#history-log .bet-amount { font-size: 0.85em; color: #ddd; margin-left: 15px; font-weight: bold; }
#history-log .score-change-history { font-size: 0.9em; text-align: right; margin-top: 4px; }
#history-log .score-change-history .gain { color: #90ee90; font-weight: bold; }
#history-log .score-change-history .loss { color: #ff7b7b; font-weight: bold; }
#history-log .win-streak { color: #ffeb3b; font-weight: bold; font-style: italic; margin-left: 5px; animation: pulseYellow 1.5s infinite ease-in-out; }
#history-log .npc-losing-streak { color: #add8e6; font-style: italic; margin-left: 5px; animation: pulseBlue 1.8s infinite ease-in-out; font-weight: bold; }
#history-log .parent-info { font-size: 0.85em; color: #ccc; margin-left: 8px; font-weight: normal; }
.wave-clear-info { display: block; margin-top: 5px; margin-bottom: 5px; font-size: 0.9em; color: #90ee90; font-weight: bold; text-align: center; background-color: rgba(40, 167, 69, 0.2); padding: 3px 6px; border-radius: 4px; }

/* ===== カード一覧モーダル(設定内) ===== */
.card-list-filter-tabs { display: flex; justify-content: flex-start; gap: 5px; margin-bottom: 15px; padding-left: 5px; border-bottom: 2px solid rgba(255, 255, 255, 0.1); }
.filter-tab { padding: 8px 15px; font-size: 0.9em; background-color: rgba(255, 255, 255, 0.05); color: #aaa; border: none; border-top-left-radius: 6px; border-top-right-radius: 6px; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease; position: relative; bottom: -2px; border-bottom: 2px solid transparent; font-weight: 500; box-shadow: none; }
.filter-tab:hover { background-color: rgba(255, 255, 255, 0.1); color: #ccc; }
.filter-tab.active { background-color: #2a2a3a; color: #ffeb3b; border-bottom: 2px solid #ffeb3b; font-weight: bold; transform: translateY(1px); }
#settings-card-list-content.filter-active .card-type-passive { display: none; }
#settings-card-list-content.filter-passive .card-type-active { display: none; }
#settings-card-list-inner { margin-top: 10px; }
#settings-card-list-content { max-height: 60vh; overflow-y: auto; text-align: left; padding-right: 10px; }
.card-list-item { background-color: rgba(70, 70, 100, 0.6); margin-bottom: 12px; padding: 15px 20px; border-radius: 8px; border-left: 6px solid #ccc; transition: opacity 0.3s ease, max-height 0.3s ease; overflow: hidden; }
.card-list-item h3 { margin: 0 0 8px 0; color: #ffeb3b; font-size: 1.2em; display: flex; justify-content: space-between; align-items: baseline; flex-wrap: wrap; gap: 5px 15px;}
.card-list-item h3 .card-meta { font-size: 0.8em; color: #ccc; font-weight: normal; }
.card-list-item .card-meta span { margin-left: 10px; font-weight: normal; }
.card-list-item h3 .card-meta .type-support, .card-list-item h3 .card-meta .type-dice, .card-list-item h3 .card-meta .type-score { font-weight: 500; }
.card-list-item h3 .card-meta .rarity-normal, .card-list-item h3 .card-meta .rarity-rare, .card-list-item h3 .card-meta .rarity-epic, .card-list-item h3 .card-meta .rarity-legendary { font-weight: bold; }
.card-list-item h3 .rarity-normal { color: #bdbdbd; }
.card-list-item h3 .rarity-rare { color: #64b5f6; }
.card-list-item h3 .rarity-epic { color: #ba68c8; }
.card-list-item h3 .rarity-legendary { color: #ffb74d; }
.card-list-item h3 .type-support { color: #81b7f3; }
.card-list-item h3 .type-dice { color: #f18a8a; }
.card-list-item h3 .type-score { color: #77cc87; }
.card-list-item p { margin: 5px 0; line-height: 1.5; font-size: 0.95em; }
.card-list-item .flavor-text { font-style: italic; color: #bbb; font-size: 0.9em; margin-bottom: 8px; }
.card-list-item .effect-details { font-size: 0.9em; color: #e0e0e0; background-color: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; margin-top: 8px; }
.effect-details .effect-level-title { margin-top: 8px; margin-bottom: 2px; color: #ffcc70; }
.effect-details .effect-level-description { padding-left: 10px; border-left: 2px solid rgba(255, 255, 255, 0.1); margin-bottom: 8px; }
.effect-details .effect-level-title:first-of-type { margin-top: 0; }

/* ===== ショップ画面レイアウト ===== */
#shop-screen {
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 1vh 1vw; /* ★ 上下の余白をさらに詰める */
    box-sizing: border-box;
    z-index: 1;
    overflow: hidden;
    height: 100vh;
}
/* ショップ全体のコンテナ */
.shop-outer-container {
    width: 98%; /* ★ 横幅をほぼ最大に */
    height: 98%; /* ★ 高さをほぼ最大に */
    max-width: 1300px; /* ★ 最大幅を少し広げる */
    max-height: 100vh; /* ★ 最大高さをビューポートに合わせる */
    background-color: rgba(35, 35, 55, 0.9);
    border-radius: 15px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
    z-index: 2;
}
.shop-header {
    background-color: rgba(40, 40, 60, 0.95);
    padding: 10px 20px 8px 20px; /* ★ 上下パディングを詰める */
    border-bottom: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.4);
    flex-shrink: 0;
    z-index: 3;
    text-align: center;
}
#shop-scrollable-offers {
    flex-grow: 1; /* ★ 残りの高さを埋める */
    overflow-y: auto; /* ★ 縦スクロール */
    padding: 10px 15px;
    background-color: rgba(30, 30, 50, 0.9);
    z-index: 1;
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.1);
}
#shop-scrollable-offers::-webkit-scrollbar { width: 8px; } #shop-scrollable-offers::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 4px; } #shop-scrollable-offers::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; } #shop-scrollable-offers::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }
.shop-footer {
    background-color: rgba(40, 40, 60, 0.95);
    padding: 10px 20px 10px 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.4);
    flex-shrink: 0; /* ★ 高さ固定 */
    z-index: 3;
}
@keyframes fadeInShop { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

/* ヘッダー内の要素 */
.shop-title { 
color: #ffcc70; margin-top: 0; margin-bottom: 15px; font-size: 3em; font-family: 'Yuji Syuku', serif;
color: #0ff; /* 基本の文字色 (シアン系) */
position: relative; /* 疑似要素を使う場合のため */
color: #0ff;
animation:
        neonFlicker 4s infinite alternate,
        textGlow 2s infinite alternate,
        neonSway 8s infinite ease-in-out; /* ★ ゆっくり左右に揺れるアニメーション追加 */
    transform-origin: bottom center; /* ★ 回転の中心をテキストの下部中央に */}
.shop-title .neon-yellow {
    /* 黄色系ネオンの色とアニメーション */
    color: #ff0; /* 基本色 (黄色) */
    animation: neonFlickerYellow 3.5s infinite alternate, textGlowYellow 2.5s infinite alternate;
}
.shop-title .neon-pink {
    color: #f0f; /* 基本色 (マゼンタ/ピンク) */
    /* ★ ピンク用のネオンアニメーションを適用 */
    animation: neonFlickerPink 4.5s infinite alternate, textGlowPink 2.2s infinite alternate;
}
@keyframes neonFlicker {
    0%, 18%, 22%, 25%, 53%, 57%, 100% {
      text-shadow:
        0 0 4px #fff, 0 0 10px #0ff, 0 0 20px #0ff, 0 0 40px #0ff,
        0 0 80px #0ff, 0 0 90px #0ff, 0 0 100px #0ff, 0 0 150px #0ff;
      opacity: 1;
    }
    20%, 24%, 55% { text-shadow: none; opacity: 0.4; }
    /* ピンク点滅部分は削除してもOK */
    /* 28%, 33% { ... } */
    /* 30%, 35% { ... } */
    50% { /* 中間での強い光 */
      text-shadow:
        0 0 5px #fff, 0 0 15px #0ff, 0 0 25px #0ff, 0 0 50px #0ff,
        0 0 90px #0ff, 0 0 110px #0ff, 0 0 130px #0ff, 0 0 180px #0ff;
      opacity: 1;
    }
  }
  
  /* テキスト自体のわずかな光り方 (基本: シアン) */
@keyframes textGlow { from { color: #0ff; } to { color: #5ffffc; } }
  
  /* 黄色系ネオン用の点滅アニメーション */
@keyframes neonFlickerYellow {
    0%, 15%, 20%, 28%, 60%, 68%, 100% {
      /* 点灯状態 (黄色) */
      text-shadow:
        0 0 4px #fff,
        0 0 10px #ff0, /* 黄色 */
        0 0 20px #ff0,
        0 0 35px #ff0,
        0 0 50px #ff0;
      opacity: 0.95; /* 常に完全には光らない感じ */
    }
    17%, 25%, 65% {
      /* 消えかけ */
      text-shadow: none;
      opacity: 0.3;
    }
    /* ★ ランダム感を出すため、消えるタイミングをずらす */
    40%, 45% {
        text-shadow: none;
        opacity: 0.5;
    }
     80%, 85% {
         text-shadow: 0 0 4px #fff, 0 0 8px #ff0; /* 弱めに光る */
         opacity: 0.7;
     }
  }
  /* 黄色系ネオン用のテキスト色変化 */
@keyframes textGlowYellow {
      from { color: #ff0; }
      to { color: #fff08f; } /* 少し明るい黄色 */
  }
@keyframes neonSway {
    0%, 100% {
      transform: rotate(-1deg); /* 開始/終了位置 (少し左傾き) */
    }
    50% {
      transform: rotate(1deg); /* 中間位置 (少し右傾き) */
    }
  }
  @keyframes neonFlickerPink {
    0%, 16%, 23%, 29%, 51%, 59%, 100% {
      /* 点灯状態 (ピンク) */
      text-shadow:
        0 0 5px #fff,
        0 0 12px #f0f, /* ピンク */
        0 0 22px #f0f,
        0 0 45px #f0f,
        0 0 70px #f0f;
      opacity: 1;
    }
    19%, 26%, 55% {
      /* 消えかけ */
      text-shadow: none;
      opacity: 0.35;
    }
    /* ★ 別のタイミングで弱く光る */
    70%, 77% {
         text-shadow: 0 0 5px #fff, 0 0 10px #f0f;
         opacity: 0.6;
    }
    73%, 80% {
        text-shadow: none;
        opacity: 0.2;
    }
  }
  /* ピンク系ネオン用のテキスト色変化 */
@keyframes textGlowPink {
      from { color: #f0f; } /* マゼンタ */
      to { color: #ff79ff; } /* 明るいピンク */
  }
#player-status { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 2px; background-color: rgba(0,0,0,0.2); padding: 4px 8px; border-radius: 4px; flex-wrap: wrap; gap: 10px 20px; }
#coin-display { font: size 1.5em; color: #ffeb3b; font-weight: bold; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); text-align: left; flex-basis: auto; }
#coin-display #player-coins { font-size: 1.5em; }
#shop-player-score { font-size: 1.3em; color: #eee; font-weight: bold; text-align: center; flex-basis: auto; }
#shop-player-score-value { color: #ffeb3b; }
#shop-player-hand { font-size: 0.85em; color: #ccc; text-align: right; flex-basis: 100%; max-width: none; }
#hand-cards { list-style: none; padding: 0; margin: 5px 0 0 0; display: flex; flex-wrap: wrap; justify-content: flex-end; gap: 5px 8px; max-height: 50px; overflow-y: auto; scrollbar-width: thin; scrollbar-color: rgba(255, 255, 255, 0.1) rgba(0,0,0,0.1); }
#hand-cards::-webkit-scrollbar { height: 4px; width: 4px; } #hand-cards::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); } #hand-cards::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 2px;}
.hand-card-item { background-color: rgba(255, 255, 255, 0.1); padding: 3px 8px; border-radius: 10px; font-size: 0.9em; white-space: nowrap; cursor: default; display: flex; align-items: center; gap: 8px; }
.sell-card-button { background-color: rgba(220, 53, 69, 0.7); color: #eee; border: none; border-radius: 10px; padding: 2px 6px; font-size: 0.8em; font-weight: bold; cursor: pointer; transition: background-color 0.2s ease; }
.sell-card-button:hover { background-color: rgba(220, 53, 69, 0.9); }
.sell-card-button:disabled { background-color: #555 !important; color: #999 !important; cursor: not-allowed; }
.shop-message { font-size: 1em; color: #ccc; margin-bottom: 10px; min-height: 1em; }

/* オファーコンテナとセクション */
.shop-offers-container { width: 100%; margin-bottom: 0; } 
.shop-section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px dashed rgba(255, 255, 255, 0.15); }
.shop-section:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; }
.shop-section-title { font-size: 1.3em; color: #ffcc70; text-align: left; margin-top: 0; margin-bottom: 15px; padding-left: 5px; font-weight: 500; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
.shop-item-row {
    display: flex;
    flex-wrap: nowrap;
    gap: 15px;
    justify-content: center; 
    padding: 8px 12px;
    background-color: rgba(0, 0, 0, 0.15);
    border-radius: 8px;
    min-height: 150px;
    align-items: stretch;
    overflow-x: auto;
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.1);
}
.shop-item-row::-webkit-scrollbar { height: 8px; } .shop-item-row::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 4px; } .shop-item-row::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; } .shop-item-row::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }
.shop-empty-message { display: flex; justify-content: center; align-items: center; width: 100%; color: #888; font-style: italic; min-height: 100px; }
#shop-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 0; padding-top: 0; border-top: none; }
#shop-confirmation-buttons { display: flex; justify-content: center; gap: 15px; margin-top: 0; padding-top: 0; border-top: none; }
/* ショップアクション */
#shop-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); }
#reroll-button { padding: 8px 18px; font-size: 1.2em; background: linear-gradient(180deg, #5bc0de, #31b0d5); color: white; }
#reroll-button:hover:not(:disabled) { background: linear-gradient(180deg, #70cce6, #4ac0e0); transform: translateY(-1px); box-shadow: 0 3px 6px rgba(0,0,0,0.3); }
.reroll-icon { font-size: 1.4em; margin-right: 5px; vertical-align: middle; display: inline-block; transition: transform 0.5s ease; }
#reroll-button:hover:not(:disabled) .reroll-icon { transform: rotate(180deg); }
#close-shop-button { padding: 10px 25px; font-size: 1.4em; cursor: pointer; border: none; border-radius: 20px; color: white; font-weight: bold; transition: all 0.2s ease; text-shadow: 0px -1px 1px rgba(0,0,0,0.4); box-shadow: 0 3px 5px rgba(0,0,0,0.3); background: linear-gradient(180deg, #f0ad4e, #ec971f); margin-top: 0; }
#close-shop-button:hover { background: linear-gradient(180deg, #f3bc70, #f0a540); transform: translateY(-2px); box-shadow: 0 5px 10px rgba(236, 151, 31, 0.4); }
#shop-confirmation-buttons { display: flex; justify-content: center; gap: 15px; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); }
#shop-confirmation-buttons button { padding: 10px 25px; font-size: 1.1em; }

/* ショップカード要素 (変更なし) */
.card { border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 10px; padding: 15px 15px 50px 15px; width: 200px; min-height: 280px; flex-shrink: 0; box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(0,0,0,0.2); display: flex; flex-direction: column; transition: transform 0.2s ease, box-shadow 0.2s ease; position: relative; overflow: hidden; background-size: cover; background-position: center center; background-repeat: no-repeat; background-color: rgba(60, 60, 90, 0.8); }
.card:not(.sold-out):hover { transform: translateY(-6px) scale(1.03); box-shadow: 5px 10px 15px rgba(0, 0, 0, 0.5), inset 0 0 8px rgba(0,0,0,0.3); }
.card::before { content: ""; position: absolute; top: 0; left: -85%; z-index: 2; display: block; width: 50%; height: 100%; background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,.3) 50%, rgba(255,255,255,0) 100%); transform: skewX(-25deg); opacity: 0; transition: opacity 0.3s; }
.card.rarity-rare::before { animation: shining 3.5s infinite linear; opacity: 1; }
.card.rarity-epic::before { animation: shining 2.8s infinite linear; opacity: 1; }
.card.rarity-legendary::before { width: 70%; animation: shining 2.2s infinite linear .2s; opacity: 1; }
@keyframes shining { 0% { left: -100%; } 40%, 100% { left: 120%; } }
.card-type-badge { position: absolute; top: 0; left: 0; padding: 3px 10px; font-size: 0.8em; font-weight: bold; border-radius: 10px 0 10px 0; color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); z-index: 1; }
.card-rarity-badge { position: absolute; top: 0; right: 0; padding: 3px 10px; font-size: 0.8em; font-weight: bold; border-radius: 0 10px 0 10px; color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); z-index: 1; }
.card.rarity-normal .card-rarity-badge { background-color: #9e9e9e; }
.card.rarity-rare .card-rarity-badge { background-color: #4a90e2; }
.card.rarity-epic .card-rarity-badge { background-color: #9c27b0; }
.card.rarity-legendary .card-rarity-badge { background-color: #ff9800; }
.card.type-support .card-type-badge { background-color: #4a90e2; }
.card.type-dice .card-type-badge { background-color: #e65252; }
.card.type-score .card-type-badge { background-color: #28a745; }
.card-name { font-size: 1.2em; color: #ffeb3b; margin-top: 15px; margin-bottom: 8px; font-weight: 800; text-shadow: 1px 1px 3px rgba(0,0,0,0.6); background-color: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.2); padding: 5px 10px; border-radius: 8px; display: inline-block; line-height: 1.3; text-align: center; }
.card-name .card-level { display: block; font-size: 0.8em; color: #ffcc70; font-weight: normal; }
.card-level-value-2 { color: #90ee90; text-shadow: 0 0 3px #28a745; font-weight: bold;}
.card-level-value-3 { color: #ff8c00; text-shadow: 0 0 5px #ffeb3b; font-weight: bold;}
.card-description { font-size: 0.9em; color: #e8e8e8; line-height: 1.5; text-align: left; margin-bottom: 10px; flex-grow: 1; position: relative; z-index: 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.9), -1px -1px 2px rgba(0,0,0,0.9), 1px -1px 2px rgba(0,0,0,0.9), -1px 1px 2px rgba(0,0,0,0.9); background-color: rgba(0, 0, 0, 0.5); padding: 8px; border-radius: 5px; box-sizing: border-box; }
.card-footer { position: absolute; bottom: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; align-items: center; padding-top: 0; border-top: none; }
.card-cost { font-size: 1.0em; font-weight: bold; color: #ffcc70; background-color: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.2); padding: 6px 12px; border-radius: 15px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
.card-cost::after { display: none; }
.card.upgradeable.max-level .card-cost { color: #aaa; font-style: italic; font-weight: normal; background-color: rgba(50, 50, 50, 0.4); border-color: rgba(150, 150, 150, 0.4); }
.card.upgradeable.max-level .card-cost::after { display: none; }
.buy-button { padding: 6px 14px; font-size: 0.9em; cursor: pointer; border: none; border-radius: 15px; color: #333; font-weight: bold; transition: all 0.2s ease; text-shadow: 0px 1px 1px rgba(255,255,255,0.3); box-shadow: 0 2px 4px rgba(0,0,0,0.3); background: linear-gradient(180deg, #ffeb3b, #ffc107); }
.buy-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(255, 200, 0, 0.4); }
.buy-button:disabled { background-color: #555 !important; background-image: none !important; color: #999 !important; cursor: not-allowed; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4); text-shadow: none; }
.pack, .boost-item { border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 10px; padding: 15px 15px 50px 15px; width: 200px; min-height: 280px; flex-shrink: 0; box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(0,0,0,0.2); display: flex; flex-direction: column; transition: transform 0.2s ease, box-shadow 0.2s ease; position: relative; overflow: hidden; background-size: cover; background-position: center center; background-repeat: no-repeat; background-color: rgba(80, 60, 100, 0.8); text-align: center; }
.pack:not(.sold-out):hover, .boost-item:not(.sold-out):hover { transform: translateY(-6px) scale(1.03); box-shadow: 5px 10px 15px rgba(0, 0, 0, 0.5), inset 0 0 8px rgba(0,0,0,0.3); }
.pack .card-name, .boost-item .card-name { font-size: 1.1em; color: #e0e0e0; margin-top: 15px; margin-bottom: 10px; font-weight: bold; background-color: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 255, 255, 0.25); padding: 6px 10px; border-radius: 8px; display: inline-block; }
.pack .card-description, .boost-item .card-description { font-size: 0.9em; color: #d0d0d0; line-height: 1.5; text-align: left; margin-bottom: 10px; flex-grow: 1; background-color: rgba(0, 0, 0, 0.4); padding: 8px; border-radius: 5px; box-sizing: border-box; text-shadow: 1px 1px 1px rgba(0,0,0,0.7); }
.pack .card-footer, .boost-item .card-footer { position: absolute; bottom: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; align-items: center; }
.pack .card-cost, .boost-item .card-cost { font-size: 1.0em; font-weight: bold; color: #ffcc70; background-color: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.2); padding: 6px 12px; border-radius: 15px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
.pack .buy-button, .boost-item .buy-button { padding: 6px 14px; font-size: 0.9em; cursor: pointer; border: none; border-radius: 15px; color: white; font-weight: bold; transition: all 0.2s ease; text-shadow: 0px 1px 1px rgba(0,0,0,0.4); box-shadow: 0 2px 4px rgba(0,0,0,0.3); background: linear-gradient(180deg, #6fa8dc, #4a90e2); }
.pack .buy-button:hover:not(:disabled), .boost-item .buy-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(74, 144, 226, 0.4); background: linear-gradient(180deg, #81b7f3, #5aa1e9); }
.pack .buy-button:disabled, .boost-item .buy-button:disabled { background-color: #555 !important; background-image: none !important; color: #999 !important; cursor: not-allowed; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4); text-shadow: none; }
.pack.sold-out, .boost-item.sold-out { opacity: 0.55; pointer-events: none; position: relative; box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(0,0,0,0.2); animation: none; border-color: rgba(255, 255, 255, 0.15); }
.pack.sold-out::after, .boost-item.sold-out::after { content: "SOLD OUT"; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg) scale(1.1); background-color: rgba(220, 53, 69, 0.9); color: white; padding: 10px 18px; font-size: 1.3em; font-weight: bold; border-radius: 8px; z-index: 10; text-shadow: 2px 2px 3px rgba(0,0,0,0.6); box-shadow: 3px 3px 7px rgba(0,0,0,0.4); white-space: nowrap; border: 2px solid rgba(255, 255, 255, 0.5); }
.pack.sold-out .card-footer, .boost-item.sold-out .card-footer { display: none; }
.card.upgradeable { border-color: #ffeb3b; position: relative; animation: upgradePulse 1.8s infinite ease-in-out; }
.card.upgradeable:not(.sold-out):hover { box-shadow: 0 0 25px rgba(255, 235, 59, 0.6), inset 0 0 12px rgba(255, 235, 59, 0.25), 5px 10px 15px rgba(0, 0, 0, 0.5); }
@keyframes upgradePulse { 0%, 100% { transform: scale(1); border-width: 1px; box-shadow: 0 0 12px rgba(255, 235, 59, 0.4), inset 0 0 6px rgba(255, 235, 59, 0.15), 3px 3px 8px rgba(0, 0, 0, 0.4); } 50% { transform: scale(1.025); border-width: 2px; box-shadow: 0 0 20px rgba(255, 235, 59, 0.7), inset 0 0 10px rgba(255, 235, 59, 0.3), 4px 6px 12px rgba(0, 0, 0, 0.45); } }
.card.upgradeable-lv3 { border-color: #ff8c00; animation: upgradePulseLv3 1.5s infinite ease-in-out; }
.card.upgradeable-lv3:not(.sold-out):hover { box-shadow: 0 0 30px rgba(255, 140, 0, 0.7), inset 0 0 15px rgba(255, 140, 0, 0.3), 5px 10px 15px rgba(0, 0, 0, 0.5); }
@keyframes upgradePulseLv3 { 0%, 100% { transform: scale(1) rotate(0deg); border-width: 2px; box-shadow: 0 0 15px rgba(255, 140, 0, 0.5), inset 0 0 8px rgba(255, 140, 0, 0.2), 3px 3px 8px rgba(0, 0, 0, 0.4); } 50% { transform: scale(1.04) rotate(2deg); border-width: 3px; box-shadow: 0 0 25px rgba(255, 140, 0, 0.8), inset 0 0 12px rgba(255, 140, 0, 0.4), 5px 8px 15px rgba(0, 0, 0, 0.5); } }
.card .card-level { display: block; font-size: 0.8em; color: #ffcc70; font-weight: normal; }
.upgrade-button { background: linear-gradient(180deg, #90ee90, #28a745); color: #333; }
.upgrade-button:hover:not(:disabled) { background: linear-gradient(180deg, #a0f0a0, #30c050); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(40, 167, 69, 0.4); }
.card.upgradeable.max-level { filter: grayscale(50%); border-color: #aaa; box-shadow: inset 0 0 10px rgba(0,0,0,0.4), 3px 3px 8px rgba(0, 0, 0, 0.4); animation: none; }
.card.upgradeable.max-level .upgrade-button { display: none; }
.card.upgradeable.max-level .card-cost { color: #aaa; font-style: italic; font-weight: normal; background-color: rgba(50, 50, 50, 0.4); border-color: rgba(150, 150, 150, 0.4); }
.card.upgradeable.max-level .card-cost::after { display: none; }
.card.sold-out { opacity: 0.55; pointer-events: none; position: relative; box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(0,0,0,0.2); animation: none; border-color: rgba(255, 255, 255, 0.15); }
.card.sold-out::after { content: "SOLD OUT"; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg) scale(1.1); background-color: rgba(220, 53, 69, 0.9); color: white; padding: 10px 18px; font-size: 1.3em; font-weight: bold; border-radius: 8px; z-index: 10; text-shadow: 2px 2px 3px rgba(0,0,0,0.6); box-shadow: 3px 3px 7px rgba(0,0,0,0.4); white-space: nowrap; border: 2px solid rgba(255, 255, 255, 0.5); }
.card.sold-out .card-footer { display: none; }

/* カード破棄モーダル */
.discard-modal-content { max-width: 500px; text-align: center; }
.modal h3 { margin-top: 0; color: #ffcc70; font-size: 1.5em; margin-bottom: 15px; }
.modal p { color: #ccc; margin-bottom: 20px; }
#discard-options { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 25px; }
.discard-choice-button { padding: 8px 15px; font-size: 0.9em; cursor: pointer; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 15px; background-color: rgba(255, 255, 255, 0.1); color: #eee; transition: background-color 0.2s ease, border-color 0.2s ease; }
.discard-choice-button:hover { background-color: rgba(255, 255, 255, 0.2); border-color: rgba(255, 255, 255, 0.4); }
#cancel-discard-button { background: linear-gradient(180deg, #8a94a8, #6c757d); color: white; text-shadow: 0px -1px 1px rgba(0,0,0,0.4); }
#cancel-discard-button:hover { background: linear-gradient(180deg, #9fa8b8, #7c858d); transform: translateY(-2px); box-shadow: 0 5px 10px rgba(108, 117, 125, 0.4); }

/* ダイス選択オーバーレイ */
.overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.75); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 50; border-radius: 12px; padding: 20px; box-sizing: border-box; }
.overlay h3 { color: #ffcc70; margin-bottom: 10px; }
.overlay p { color: #eee; margin-bottom: 20px; }
.dice-choice-buttons { display: flex; flex-direction: column; gap: 10px; align-items: center; }
.dice-choice-button { font-size: 2em; padding: 10px 20px; font-family: monospace; min-width: 60px; background: linear-gradient(180deg, #ffeb3b, #ffc107); color: #333; }

/* サイコロロールモーダル */
.dice-roll-modal {}
.dice-roll-modal-content { background-color: transparent; border: none; box-shadow: none; max-width: 60vw; width: 60vw; aspect-ratio: 16 / 9; padding: 0; display: flex; justify-content: center; align-items: center; animation: rollModalAppear 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; overflow: hidden; margin: auto; }
@keyframes rollModalAppear { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }
#dice-roll-modal-display { width: 100%; height: 100%; }
.dice-roll-modal-content .close-button { top: 10px; right: 15px; z-index: 1051; color: rgba(255, 255, 255, 0.7); text-shadow: 1px 1px 3px rgba(0,0,0,0.7); }
.dice-roll-modal-content .close-button:hover { color: rgba(255, 255, 255, 1); }

/* 設定モーダル */
.settings-modal-content { max-width: 700px; }
.settings-navigation { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.15); flex-wrap: wrap; }
.settings-nav-button { padding: 8px 18px; font-size: 1em; background-color: rgba(255, 255, 255, 0.1); color: #ccc; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 15px; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease; font-weight: normal; box-shadow: none; }
.settings-nav-button:hover { background-color: rgba(255, 255, 255, 0.15); color: #fff; border-color: rgba(255, 255, 255, 0.3); }
.settings-nav-button.active { background: linear-gradient(180deg, #ffeb3b, #ffc107); color: #333; font-weight: bold; border-color: #ffc107; }
#settings-content { max-height: 60vh; overflow-y: auto; text-align: left; padding-right: 10px; }
#settings-content h3 { color: #ffcc70; margin-top: 0; margin-bottom: 15px; border-bottom: 1px dashed rgba(255, 255, 255, 0.2); padding-bottom: 8px; }
#settings-content ul, #settings-content dl { font-size: 0.95em; line-height: 1.7; color: #ddd; }
#settings-content ul { padding-left: 20px; list-style: disc; }
#settings-content li { margin-bottom: 8px; }
#settings-content dt { font-weight: bold; color: #ffeb3b; margin-top: 15px; text-shadow: 1px 1px 2px rgba(0,0,0,0.4); }
#settings-content dd { margin-left: 15px; margin-bottom: 8px; line-height: 1.5; color: #ccc; }
#settings-content strong { font-weight: bold; }
#settings-content .payout-win { color: #ff9800; }
#settings-content .payout-win-normal { color: #ffeb3b; }
#settings-content .payout-lose { color: #e91e63; }
#settings-content .payout-neutral { color: #ccc; }
.settings-tab-content { display: none; animation: fadeIn 0.3s ease-out; }
.settings-tab-content.active { display: block; }
#settings-content::-webkit-scrollbar { width: 8px; } #settings-content::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 4px; } #settings-content::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; } #settings-content::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }
.score-calculation-info { background-color: rgba(0, 0, 0, 0.2); padding: 15px 20px; border-radius: 8px; margin-bottom: 25px; border: 1px solid rgba(255, 255, 255, 0.1); }
.score-calculation-info h4 { margin-top: 0; margin-bottom: 10px; color: #eee; font-size: 1.1em; text-align: center; border-bottom: none; }
.score-calculation-info p { margin-bottom: 8px; font-size: 0.9em; line-height: 1.6; color: #ccc; }
.calculation-formula { font-family: monospace; font-size: 1em; background-color: rgba(0, 0, 0, 0.3); padding: 10px; border-radius: 4px; text-align: center; word-wrap: break-word; }
.calculation-formula strong { color: #ffeb3b; }
.calculation-formula .formula-part { color: #aaa; }
.score-calculation-info small { font-size: 0.8em; color: #aaa; display: block; text-align: center; margin-top: 5px; }
.tooltip { position: relative; border-bottom: 1px dotted #aaa; cursor: help; color: #87CEFA; }
.tooltip:hover::after { content: attr(title); position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%); background-color: rgba(50, 50, 70, 0.95); color: #eee; padding: 5px 10px; border-radius: 4px; font-size: 0.8em; white-space: nowrap; z-index: 10; box-shadow: 0 2px 5px rgba(0,0,0,0.5); border: 1px solid rgba(255, 255, 255, 0.1); font-family: 'M PLUS Rounded 1c', sans-serif; font-weight: normal; font-style: normal; }
.card-effect-rate { font-size: 0.85em; color: #aaa; margin-left: 15px; margin-top: -5px; margin-bottom: 10px; font-style: italic; }
.card-effect-rate span { font-weight: bold; color: #87CEFA; font-style: normal; }
#settings-rules-content h4 { font-size: 1.1em; color: #87CEFA; margin-top: 20px; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dotted rgba(135, 206, 250, 0.5); font-weight: bold; }
#settings-rules-content h4:first-of-type { margin-top: 0; }
#settings-rules-content ul { padding-left: 25px; margin-bottom: 15px; list-style-type: '🎲 '; }
#settings-rules-content li { margin-bottom: 10px; line-height: 1.8; color: #d8d8d8; }
#settings-rules-content strong { color: #ffeb3b; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); }

/* ===== カード一覧モーダル(設定内) ===== */
.card-list-filter-tabs { display: flex; justify-content: flex-start; gap: 5px; margin-bottom: 15px; padding-left: 5px; border-bottom: 2px solid rgba(255, 255, 255, 0.1); }
.filter-tab { padding: 8px 15px; font-size: 0.9em; background-color: rgba(255, 255, 255, 0.05); color: #aaa; border: none; border-top-left-radius: 6px; border-top-right-radius: 6px; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease; position: relative; bottom: -2px; border-bottom: 2px solid transparent; font-weight: 500; box-shadow: none; }
.filter-tab:hover { background-color: rgba(255, 255, 255, 0.1); color: #ccc; }
.filter-tab.active { background-color: #2a2a3a; color: #ffeb3b; border-bottom: 2px solid #ffeb3b; font-weight: bold; transform: translateY(1px); }
#settings-card-list-content.filter-active .card-type-passive { display: none; }
#settings-card-list-content.filter-passive .card-type-active { display: none; }
#settings-card-list-inner { margin-top: 10px; }
#settings-card-list-content { max-height: 60vh; overflow-y: auto; text-align: left; padding-right: 10px; }
.card-list-item { background-color: rgba(70, 70, 100, 0.6); margin-bottom: 12px; padding: 15px 20px; border-radius: 8px; border-left: 6px solid #ccc; transition: opacity 0.3s ease, max-height 0.3s ease; overflow: hidden; }
.card-list-item h3 { margin: 0 0 8px 0; color: #ffeb3b; font-size: 1.2em; display: flex; justify-content: space-between; align-items: baseline; flex-wrap: wrap; gap: 5px 15px;}
.card-list-item h3 .card-meta { font-size: 0.8em; color: #ccc; font-weight: normal; }
.card-list-item .card-meta span { margin-left: 10px; font-weight: normal; }
.card-list-item h3 .card-meta .type-support, .card-list-item h3 .card-meta .type-dice, .card-list-item h3 .card-meta .type-score { font-weight: 500; }
.card-list-item h3 .card-meta .rarity-normal, .card-list-item h3 .card-meta .rarity-rare, .card-list-item h3 .card-meta .rarity-epic, .card-list-item h3 .card-meta .rarity-legendary { font-weight: bold; }
.card-list-item h3 .rarity-normal { color: #bdbdbd; }
.card-list-item h3 .rarity-rare { color: #64b5f6; }
.card-list-item h3 .rarity-epic { color: #ba68c8; }
.card-list-item h3 .rarity-legendary { color: #ffb74d; }
.card-list-item h3 .type-support { color: #81b7f3; }
.card-list-item h3 .type-dice { color: #f18a8a; }
.card-list-item h3 .type-score { color: #77cc87; }
.card-list-item p { margin: 5px 0; line-height: 1.5; font-size: 0.95em; }
.card-list-item .flavor-text { font-style: italic; color: #bbb; font-size: 0.9em; margin-bottom: 8px; }
.card-list-item .effect-details { font-size: 0.9em; color: #e0e0e0; background-color: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; margin-top: 8px; }
.effect-details .effect-level-title { margin-top: 8px; margin-bottom: 2px; color: #ffcc70; }
.effect-details .effect-level-description { padding-left: 10px; border-left: 2px solid rgba(255, 255, 255, 0.1); margin-bottom: 8px; }
.effect-details .effect-level-title:first-of-type { margin-top: 0; }

/* ===== カードアクションモーダル ===== */
.card-action-modal-content { max-width: 1100px; max-height: 85vh; display: flex; flex-direction: column; overflow-y: auto; scrollbar-width: thin; scrollbar-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.1); }
.card-action-modal-content::-webkit-scrollbar { width: 8px; } .card-action-modal-content::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 4px; } .card-action-modal-content::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; } .card-action-modal-content::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }
.card-section { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px dashed rgba(255, 255, 255, 0.2); }
.card-section:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; }
.card-section h3 { color: #ffcc70; font-size: 1.3em; margin-top: 0; margin-bottom: 8px; text-align: left; padding-left: 5px; }
.card-section-message { font-size: 0.95em; color: #ccc; margin-bottom: 15px; min-height: 1.1em; text-align: left; padding-left: 5px; font-style: italic; }
.card-display-area { display: flex; flex-wrap: nowrap; gap: 15px; justify-content: center; padding: 10px 10px; background-color: rgba(0, 0, 0, 0.15); border-radius: 8px; min-height: 290px; align-content: flex-start; overflow-x: auto; scrollbar-width: thin; scrollbar-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.1); }
.card-display-area::-webkit-scrollbar { height: 8px; } .card-display-area::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 4px; } .card-display-area::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; } .card-display-area::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }
.card-display-area.empty { justify-content: center; align-items: center; color: #888; font-style: italic; min-height: 100px; overflow-x: hidden; }
.card-action-item { border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 10px; padding: 15px; width: 200px; min-height: 260px; flex-shrink: 0; box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(0,0,0,0.2); display: flex; flex-direction: column; transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease; position: relative; overflow: hidden; background-size: cover; background-position: center center; background-repeat: no-repeat; background-color: rgba(60, 60, 90, 0.8); text-align: center; cursor: default; }
.card-action-item .card-type-badge, .card-action-item .card-rarity-badge { position: absolute; top: 0; padding: 3px 10px; font-size: 0.8em; font-weight: bold; color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); z-index: 1; }
.card-action-item .card-type-badge { left: 0; border-radius: 10px 0 10px 0; } .card-action-item .card-rarity-badge { right: 0; border-radius: 0 10px 0 10px; }
.card-action-item.rarity-normal .card-rarity-badge { background-color: #9e9e9e; } .card-action-item.rarity-rare .card-rarity-badge { background-color: #4a90e2; } .card-action-item.rarity-epic .card-rarity-badge { background-color: #9c27b0; } .card-action-item.rarity-legendary .card-rarity-badge { background-color: #ff9800; }
.card-action-item.type-support .card-type-badge { background-color: #4a90e2; } .card-action-item.type-dice .card-type-badge { background-color: #e65252; } .card-action-item.type-score .card-type-badge { background-color: #28a745; }
.card-action-item .card-name { font-size: 1.1em; color: #ffeb3b; margin-top: 25px; margin-bottom: 8px; font-weight: 800; text-shadow: 1px 1px 3px rgba(0,0,0,0.6); background-color: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.2); padding: 5px 8px; border-radius: 8px; display: block; text-align: center; width: auto; margin-left: auto; margin-right: auto; max-width: 90%; box-sizing: border-box; }
.card-action-item .card-level { display: block; font-size: 0.8em; color: #ffcc70; font-weight: normal; text-align: center; margin-top: -5px; margin-bottom: 10px; }
.card-action-item .card-level-value-2 { color: #90ee90; text-shadow: 0 0 3px #28a745; font-weight: bold;}
.card-action-item .card-level-value-3 { color: #ff8c00; text-shadow: 0 0 5px #ffeb3b; font-weight: bold;}
.card-action-item .card-description { font-size: 0.85em; color: #e8e8e8; line-height: 1.5; text-align: left; margin-bottom: 10px; flex-grow: 1; position: relative; z-index: 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.9), -1px -1px 2px rgba(0,0,0,0.9), 1px -1px 2px rgba(0,0,0,0.9), -1px 1px 2px rgba(0,0,0,0.9); background-color: rgba(0, 0, 0, 0.5); padding: 8px; border-radius: 5px; box-sizing: border-box; }
.card-action-item .card-action-uses { font-size: 0.9em; color: #ccc; margin-top: auto; padding-top: 10px; border-top: 1px dashed rgba(255, 255, 255, 0.15); min-height: 40px; display: flex; justify-content: center; align-items: center; width: 100%; box-sizing: border-box; padding-bottom: 5px; }
.card-action-item .use-card-button { margin-top: 10px; padding: 8px 20px; font-size: 1em; width: 100%; box-sizing: border-box; background: linear-gradient(180deg, #5bc0de, #31b0d5); color: white; }
.card-action-item .use-card-button:hover:not(:disabled) { background: linear-gradient(180deg, #70cce6, #4ac0e0); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(49, 176, 213, 0.4); }
.card-action-item .use-card-button:disabled { background-color: #555; background-image: none; color: #999; cursor: not-allowed; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4); text-shadow: none; }
.card-action-item.not-usable { filter: grayscale(70%) brightness(0.8); cursor: not-allowed; }
.card-action-item.used-up { opacity: 0.6; filter: grayscale(90%); cursor: not-allowed; }
.card-action-item.used-up .card-action-uses { color: #888; }
.card-action-item.used-up .use-card-button { display: none; }
.card-action-item.usable { cursor: pointer; border-color: cyan; box-shadow: 0 0 15px rgba(0, 255, 255, 0.5), 3px 3px 8px rgba(0, 0, 0, 0.4); animation: usableCardPulse 1.8s infinite ease-in-out; }
.card-action-item.usable:hover { transform: translateY(-4px) scale(1.02); box-shadow: 0 0 20px rgba(0, 255, 255, 0.7), 5px 7px 12px rgba(0, 0, 0, 0.5); }
@keyframes usableCardPulse { 0%, 100% { border-color: cyan; box-shadow: 0 0 15px rgba(0, 255, 255, 0.5), 3px 3px 8px rgba(0, 0, 0, 0.4); } 50% { border-color: #3fffff; box-shadow: 0 0 22px rgba(0, 255, 255, 0.7), 3px 3px 8px rgba(0, 0, 0, 0.4); } }
.card-action-item.passive { cursor: default; animation: none; border-color: rgba(255, 255, 255, 0.15); }
.card-action-item.passive:hover { transform: none; box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4), inset 0 0 5px rgba(0,0,0,0.2); }
.card-action-item.passive .use-card-button { display: none; }
.passive-status { display: inline-block; width: calc(100% - 10px); padding: 8px 10px; font-size: 1em; font-weight: bold; color: #ffffff; background: linear-gradient(180deg, #90ee90, #28a745); border-radius: 15px; box-sizing: border-box; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); box-shadow: 0 2px 4px rgba(0,0,0,0.3); margin-top: 10px; margin-left: 5px; margin-right: 5px; }

/* スマホ表示調整 (カードアクションモーダル) */
@media (max-width: 768px) {
    .card-action-modal-content { max-width: 95vw; }
    .card-display-area { min-height: 280px; padding: 10px 10px; justify-content: flex-start; }
}
@media (max-width: 480px) {
    .card-display-area { min-height: 280px; padding: 8px 8px; }
}

/* ===== アイテム獲得演出モーダル ===== */
.item-reveal-modal { z-index: 1100; backdrop-filter: blur(8px) brightness(0.7); }
.item-reveal-content { background: radial-gradient(ellipse at center, rgba(60, 60, 90, 0.95) 0%, rgba(30, 30, 50, 0.98) 100%); border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7); max-width: 450px; text-align: center; padding: 35px; position: relative; overflow: hidden; transition: border-color 0.5s ease; animation: itemRevealAppear 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes itemRevealAppear { from { transform: scale(0.7) rotate(-5deg); opacity: 0; } to { transform: scale(1) rotate(0deg); opacity: 1; } }
.item-reveal-content.rarity-normal { border-color: #aaa; }
.item-reveal-content.rarity-rare { border-color: #64b5f6; box-shadow: 0 0 20px rgba(100, 181, 246, 0.6), 0 10px 40px rgba(0, 0, 0, 0.7); }
.item-reveal-content.rarity-epic { border-color: #ba68c8; box-shadow: 0 0 30px rgba(186, 104, 200, 0.7), 0 10px 40px rgba(0, 0, 0, 0.7); }
.item-reveal-content.rarity-legendary { border-color: #ffb74d; box-shadow: 0 0 40px rgba(255, 183, 77, 0.8), 0 10px 40px rgba(0, 0, 0, 0.7); animation: legendaryShine 2s infinite linear, itemRevealAppear 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes legendaryShine { 0%, 100% { box-shadow: 0 0 40px rgba(255, 183, 77, 0.8), 0 10px 40px rgba(0, 0, 0, 0.7); } 50% { box-shadow: 0 0 55px rgba(255, 183, 77, 1.0), 0 10px 40px rgba(0, 0, 0, 0.7); } }
#item-reveal-title { color: #ffcc70; margin-top: 0; margin-bottom: 20px; font-size: 1.8em; font-family: 'Yuji Syuku', serif; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
#item-reveal-body { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-bottom: 25px; }
#item-reveal-image-container { width: 200px; height: 280px; background-color: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 8px; display: flex; justify-content: center; align-items: center; overflow: hidden; }
#item-reveal-image { width: 100%; height: 100%; object-fit: cover; display: none; }
#item-reveal-placeholder { color: #888; font-size: 0.9em; display: block; }
#item-reveal-details { text-align: center; }
#item-reveal-name { font-size: 1.5em; color: #ffeb3b; margin-top: 0; margin-bottom: 8px; font-weight: bold; text-shadow: 1px 1px 3px rgba(0,0,0,0.6); }
#item-reveal-meta { font-size: 0.9em; color: #ccc; margin-bottom: 12px; display: flex; justify-content: center; gap: 15px; }
#item-reveal-meta .rarity-badge, #item-reveal-meta .type-badge { padding: 3px 8px; border-radius: 10px; font-weight: bold; text-shadow: 1px 1px 1px rgba(0,0,0,0.4); }
#item-reveal-meta .rarity-normal { background-color: #bdbdbd; color: #333; }
#item-reveal-meta .rarity-rare { background-color: #64b5f6; color: #fff; }
#item-reveal-meta .rarity-epic { background-color: #ba68c8; color: #fff; }
#item-reveal-meta .rarity-legendary { background-color: #ffb74d; color: #fff; }
#item-reveal-meta .type-support { background-color: #81b7f3; color: #fff; }
#item-reveal-meta .type-dice { background-color: #f18a8a; color: #fff; }
#item-reveal-meta .type-score { background-color: #77cc87; color: #fff; }
#item-reveal-meta .type-boost { background-color: #ffcc70; color: #333; }
#item-reveal-meta .type-pack { background-color: #a0a0a0; color: #fff; }
#item-reveal-description { font-size: 0.95em; color: #e0e0e0; line-height: 1.6; margin-bottom: 15px; background-color: rgba(0, 0, 0, 0.2); padding: 10px; border-radius: 5px; max-height: 100px; overflow-y: auto; text-align: center; font-style: italic; }
#item-reveal-level { font-size: 1.1em; color: #90ee90; font-weight: bold; margin-top: -5px; margin-bottom: 10px; }
#confirm-item-reveal-button { padding: 10px 30px; font-size: 1.1em; }

/* ===== 役/目 結果表示モーダル ===== */
.role-result-reveal-modal { z-index: 1050; background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(4px); }
.role-result-reveal-content { background: none; border: none; box-shadow: none; padding: 0; max-width: 80vw; display: flex; justify-content: center; align-items: center; animation: none; }
#role-result-modal-body { text-align: center; opacity: 0; transform: scale(0.8); }
#role-result-name { font-size: 7em; font-weight: 800; color: white; text-shadow: 3px 3px 0 #444, 6px 6px 10px rgba(0, 0, 0, 0.7); margin: 10px 0 0 0; line-height: 1.1; white-space: nowrap; }
#role-result-dice-display { font-size: 4em; font-weight: bold; color: #eee; letter-spacing: 0.1em; margin-bottom: 15px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); font-family: 'M PLUS Rounded 1c', sans-serif; }
#role-result-modal-body.reveal-start { animation: roleRevealAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
@keyframes roleRevealAppear { 0% { transform: scale(0.7) rotate(-8deg); opacity: 0; } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }
#role-result-modal-body.reveal-end { animation: roleRevealFadeOut 0.3s ease-out forwards; }
@keyframes roleRevealFadeOut { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0.8); opacity: 0; } }
.role-reveal-pinzoro #role-result-modal-body { background: radial-gradient(ellipse at center, rgba(255, 235, 0, 0.5) 0%, rgba(255, 215, 0, 0) 70%); border-radius: 50%; padding: 50px; box-shadow: 0 0 60px 20px rgba(255, 215, 0, 0.7); animation: roleRevealAppear 0.6s cubic-bezier(0.68, -0.6, 0.27, 1.55) forwards, pinzoroBgPulse 1.5s infinite ease-in-out 0.6s; }
@keyframes pinzoroBgPulse { 0%, 100% { box-shadow: 0 0 60px 20px rgba(255, 215, 0, 0.7); transform: scale(1); } 50% { box-shadow: 0 0 80px 30px rgba(255, 215, 0, 1); transform: scale(1.05); } }
.role-reveal-pinzoro #role-result-name { font-family: 'Shippori Mincho', serif; font-size: 10em; color: gold; text-shadow: 0 0 15px white, 0 0 30px gold, 0 0 45px #fff, 5px 5px 8px rgba(0,0,0,0.6); filter: drop-shadow(0 0 15px gold); animation: pinzoroTextPop 0.6s cubic-bezier(0.68, -0.6, 0.27, 1.55) forwards; }
@keyframes pinzoroTextPop { 0% { transform: scale(0.5) rotateY(90deg); opacity: 0; } 100% { transform: scale(1) rotateY(0deg); opacity: 1; } }
.role-reveal-pinzoro #role-result-dice-display { font-size: 6em; color: gold; text-shadow: 0 0 5px white, 0 0 10px gold; margin-top: 10px; }
.role-reveal-arashi #role-result-modal-body { background: radial-gradient(ellipse at center, rgba(255, 120, 0, 0.3) 0%, rgba(100, 50, 0, 0) 70%), repeating-conic-gradient(from 0deg, rgba(255,150,80,0.1) 0deg 10deg, rgba(255,100,50,0.15) 10deg 20deg); border-radius: 10px; padding: 30px 50px; animation: roleRevealAppear 0.5s cubic-bezier(0.68, -0.6, 0.27, 1.55) forwards, arashiBgRotate 10s linear infinite; }
@keyframes arashiBgRotate { from { background-position: 0% 0%; } to { background-position: 200% 200%; } }
.role-reveal-arashi #role-result-name { font-family: 'RocknRoll One', sans-serif; font-size: 8.5em; color: #ffcc80; text-shadow: 0 0 8px #ff5722, 3px 3px 6px rgba(0, 0, 0, 0.7); animation: arashiTextSpin 0.5s cubic-bezier(0.68, -0.6, 0.27, 1.55) forwards; }
@keyframes arashiTextSpin { 0% { transform: scale(0) rotate(720deg); opacity: 0; filter: blur(8px); } 100% { transform: scale(1) rotate(0deg); opacity: 1; filter: blur(0px); } }
.role-reveal-arashi #role-result-dice-display { color: #ffcc80; font-size: 4.5em; text-shadow: 0 0 5px #ff5722, 2px 2px 4px rgba(0,0,0,0.5); }
.role-reveal-shigoro #role-result-modal-body { background: linear-gradient(135deg, rgba(255,224,130,0.1) 0%, rgba(255,152,0,0.1) 50%, rgba(255,111,0,0.1) 100%); border-radius: 10px; padding: 30px 40px; border-bottom: 5px solid #ff9800; box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3); }
.role-reveal-shigoro #role-result-name { font-family: 'Yuji Syuku', serif; font-size: 7.5em; color: #ffe082; text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 5px #ff9800; animation: shigoroTextAppear 0.6s ease-out forwards; }
@keyframes shigoroTextAppear { 0% { letter-spacing: -0.5em; opacity: 0; } 40% { letter-spacing: 0.1em; } 100% { letter-spacing: 0; opacity: 1; } }
.role-reveal-shigoro #role-result-dice-display { color: #ffe082; font-size: 4.2em; }
.role-reveal-normal-eye #role-result-modal-body { padding: 25px 40px; background-color: rgba(40, 40, 80, 0.8); border-radius: 10px; }
.role-reveal-normal-eye #role-result-name { font-family: 'M PLUS Rounded 1c', sans-serif; font-size: 6.5em; color: #eee; text-shadow: 2px 2px 5px rgba(0,0,0,0.5); }
.role-reveal-normal-eye #role-result-dice-display { color: #fff; font-size: 4em; }
.role-reveal-hifumi #role-result-modal-body { padding: 30px 40px; background-color: rgba(30, 40, 70, 0.8); border-radius: 10px; box-shadow: inset 0 0 15px rgba(0,0,0,0.5); }
.role-reveal-hifumi #role-result-name { font-family: 'Yuji Syuku', serif; font-size: 7em; color: #b0c4de; text-shadow: 1px 1px 4px rgba(0,0,0,0.7), 0 0 5px #5882b4; animation: hifumiTextDrop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
@keyframes hifumiTextDrop { 0% { transform: translateY(-30px) rotate(5deg); opacity: 0; } 60% { transform: translateY(5px) rotate(-2deg); opacity: 1; } 100% { transform: translateY(0) rotate(0deg); opacity: 1; } }
.role-reveal-hifumi #role-result-dice-display { color: #b0c4de; font-size: 4.2em; opacity: 0.8; }
.role-reveal-shonben #role-result-modal-body { padding: 25px 40px; background: linear-gradient(rgba(50,50,50,0.6), rgba(30,30,30,0.8)); border-radius: 10px; }
.role-reveal-shonben #role-result-name { font-family: 'M PLUS Rounded 1c', sans-serif; font-size: 5.5em; color: #999; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); filter: blur(0.5px); animation: shonbenTextFlicker 1s linear forwards; }
@keyframes shonbenTextFlicker { 0%, 100% { opacity: 0.7; } 50% { opacity: 0.4; } }
.role-reveal-shonben #role-result-dice-display { display: none; }
.role-reveal-wave-clear #role-result-modal-body { padding: 40px 60px; position: relative; overflow: hidden; border-radius: 15px; box-shadow: 0 0 50px rgba(144, 238, 144, 0.8); animation: waveClearBodyPop 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
@keyframes waveClearBodyPop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
.role-reveal-wave-clear #role-result-modal-body::before { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at center, rgba(255,255,255,0.3) 0%, rgba(144,238,144,0) 70%), url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIAQMAAACXljzdAAAABlBMVEVVVP////8vZtJdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAHUlEQVQ4y2NgoBpgImBqBNAyAMgwgM0IFJsKANqnHbcY5t6dAAAAAElFTkSuQmCC); background-size: cover, auto; animation: move-twink-back 20s linear infinite, fadeIn 1s ease-out; opacity: 0.5; z-index: -1; }
.role-reveal-wave-clear #role-result-name { font-family: 'Shippori Mincho', serif; font-size: 8em; background: linear-gradient(45deg, #adff2f, #00ff7f, #7fffd4, #00fa9a); -webkit-background-clip: text; background-clip: text; color: transparent; background-size: 300% 300%; animation: rainbowText 3s ease infinite; text-shadow: 0 0 10px white, 0 0 20px #90ee90, 4px 4px 8px rgba(0,0,0,0.6); filter: drop-shadow(0 0 10px #90ee90); margin-bottom: 10px; }
@keyframes rainbowText { 0%{background-position:0% 82%} 50%{background-position:100% 19%} 100%{background-position:0% 82%} }
.role-reveal-game-over #role-result-modal-body { padding: 40px 50px; background: radial-gradient(ellipse at center, rgba(80, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.8) 100%); border-radius: 10px; border: 3px solid #8B0000; box-shadow: inset 0 0 20px #000, 0 0 30px rgba(139, 0, 0, 0.7); animation: screenShake 0.5s ease-in-out forwards; }
@keyframes screenShake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }
.role-reveal-game-over #role-result-name { font-family: 'Yuji Syuku', serif; font-size: 7em; color: #a52a2a; text-shadow: 0 0 5px black, 0 0 10px #ff0000, 2px 2px 4px rgba(0,0,0,0.9); animation: gameOverFlicker 0.1s linear infinite; margin-bottom: 10px; }
@keyframes gameOverFlicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; transform: skewX(-2deg); } }

/* コイン獲得アニメーション */
.coin-animation { position: fixed; width: 20px; height: 20px; background-color: gold; border-radius: 50%; border: 1px solid darkgoldenrod; box-shadow: 1px 1px 3px rgba(0,0,0,0.5); z-index: 1100; pointer-events: none; opacity: 0; animation: coinFly 1s ease-in forwards; }
@keyframes coinFly { 0% { transform: scale(0.8) translate(0, 0); opacity: 1; } 30% { transform: scale(1.2) translate(var(--tx, 0px), -50px); opacity: 1; } 100% { transform: scale(0.5) translate(var(--tx, 0px), var(--ty, 0px)); opacity: 0; } }

/* レスポンシブ調整 */
@media (max-width: 1100px) {
    #game-main-area { width: 100%; padding: 0; padding-top: 50px; }
    #game-container { max-width: 90%; }
    .shop-outer-container { width: 96%; }
    .shop-header, #shop-scrollable-offers, .shop-footer { padding-left: 20px; padding-right: 20px; }
    .shop-content { max-width: 90%; padding-left: 20px; padding-right: 20px; } /* ショップ左右パディング */
    .card { width: calc(33.33% - 15px); }
    .dice-roll-modal-content { max-width: 70vw; width: 70vw; }
    .character-image-area { width: 200px; height: 250px; }
    #control-area { max-width: 70%; }
}
@media (max-width: 880px) {
    #game-container { max-width: 90%; }
    .shop-outer-container { width: 97%; }
    .shop-header, #shop-scrollable-offers, .shop-footer { padding-left: 15px; padding-right: 15px; }
    .shop-content { max-width: 95%; padding-left: 15px; padding-right: 15px; }
    .card { width: calc(50% - 15px); min-height: 260px; }
    .dice-roll-modal-content { max-width: 80vw; width: 80vw; }
    #game-area { flex-direction: column; gap: 10px; align-items: center; }
    .player-box { width: 80%; max-width: 350px; }
    #dice-area { width: 90%; max-width: 400px; }
    .character-image-area { width: 150px; height: 180px; order: 1; }
    .character-image-area.npc { order: 3; }
    #player-info { order: 0; } #dice-area { order: 2; } #npc-info { order: 4; }
    #control-area { max-width: 80%; }
}
@media (max-width: 768px) {
    #game-header { padding: 6px 10px; } #game-coin-display { font-size: 1.1em; } #settings-button { width: 35px; height: 35px; font-size: 1.2em; }
    #game-main-area { padding-top: 45px; } #game-container { max-width: 95%; }
    .title-content, .result-content, .character-select-content { padding: 30px 20px; width: 90%; } .game-title { font-size: 3em; }
    .mode-button { padding: 10px 15px; font-size: 1em; margin: 5px 3px; } #start-game-button { padding: 12px 30px; font-size: 1.2em; } #select-character-button { padding: 10px 20px; font-size: 1em; }
    #game-screen { padding: 0; } #game-scrollable-area { padding: 10px; padding-bottom: 180px; } #game-container { padding: 15px; margin-bottom: 0; border-radius: 15px; }
    #wave-info { text-align: center; width: 100%; margin-top: 0; margin-bottom: 5px; } #current-bet-info { font-size: 1em; margin-bottom: 10px; }
    #game-area { flex-direction: column; gap: 10px; } .player-box { width: 100%; } .player-box h2 { display: flex; align-items: center; justify-content: center; } .parent-marker { font-size: 0.7em; }
    #dice-area { width: 100%; max-width: none; } .character-image-area { width: 120px; height: 150px; margin-bottom: 5px; } #dice-display { font-size: 4em; letter-spacing: 0.1em;}
    .center-role { font-size: 4.5em; padding: 0.1em 0.3em; } .center-role.role-pinzoro { font-size: 5.5em; } .center-role.role-arashi { font-size: 5em; } .center-role.role-shigoro { font-size: 5em; } .center-role.role-normal-eye { font-size: 4em; } .center-role.role-hifumi { font-size: 4.5em; } .center-role.role-shonben { font-size: 3.5em; } .center-role.result-win { font-size: 5em; } .center-role.result-lose { font-size: 4.5em; } .center-role.result-wave-clear { font-size: 6em; } .center-role.result-game-over { font-size: 5.5em; }
    #bottom-control-bar { padding: 10px 10px 15px 10px; } #control-area { gap: 10px; margin-top: 0; max-width: 95%; }
    .bet-main-controls { flex-direction: column; align-items: stretch; gap: 8px; padding: 8px; }
    .bet-input-container { order: 1; width: 100%; flex-direction: row; justify-content: space-between; align-items: center; min-width: unset; } #bet-input { flex-grow: 1; max-width: none; }
    .bet-adjust-container { order: 2; width: 100%; justify-content: space-around; }
    .bet-action-container { order: 3; width: 100%; justify-content: space-around; margin-top: 8px; padding: 8px; } .bet-action-container button { flex-grow: 1; flex-basis: auto; max-width: none; }
    #game-screen.npc-parent .bet-input-container { justify-content: center; } #game-screen.npc-parent #bet-input { flex-grow: 0; width: 80px; }
    #action-controls { gap: 10px; flex-direction: row; align-items: center;} #action-controls button { width: auto; flex-grow: 1; padding: 10px 5px; }
    .result-actions { flex-direction: column; gap: 15px; } .result-actions button { width: 100%; }
    .character-select-content { padding: 20px 15px; } #character-select-screen h2 { font-size: 2em; } .character-select-body { flex-direction: column; min-height: auto; } #character-list { max-height: 30vh; } #character-preview { min-height: 250px; } #character-preview-image { max-height: 180px; } #character-confirm-area button { padding: 8px 20px; font-size: 0.9em; } #back-to-title-button { padding: 8px 25px; font-size: 0.9em; }
    .modal-content { width: 90%; padding: 20px; max-height: 85vh; display: flex; flex-direction: column; } #history-log { font-size: 0.9em; max-height: 60vh; flex-grow: 1; }
    .card-list-modal-content { max-height: 85vh; } #card-list-content { max-height: 70vh; font-size: 0.9em; } .card-list-item h3 { font-size: 1.1em; } .card-list-item .card-meta { font-size: 0.75em; }
    #history-log .details { flex-direction: column; align-items: flex-start; } #history-log .vs { display: none; } #history-log .score-change-history { text-align: left; } #history-log .parent-info { display: block; margin-left: 0; margin-top: 3px; }
    .roll-counter-top-right { top: 8px; right: 10px; font-size: 0.8em; }
    .shop-outer-container { width: 98%; height: 95%; }
    .shop-header, #shop-scrollable-offers, .shop-footer { padding: 15px 15px; }
    #player-status { flex-direction: column; align-items: center; }
    #shop-player-hand { text-align: center; flex-basis: auto; }
    #hand-cards { justify-content: center; }
    .shop-content { max-width: 90%; padding-left: 15px; padding-right: 15px; }
    #player-status { flex-direction: column; align-items: center; text-align: center; }
    #shop-player-hand { text-align: center; flex-basis: auto; }
    #hand-cards { justify-content: center; }
    .card { width: calc(50% - 10px); min-height: 260px; padding-bottom: 60px; } .card-footer { bottom: 15px; } .card-name { font-size: 1.1em; } .card-description { font-size: 0.85em; } .card-cost { font-size: 1em; } .buy-button { font-size: 0.8em; padding: 5px 10px; }
    #close-shop-button, #reroll-button { font-size: 1em; padding: 8px 20px; }
    #discard-options { gap: 8px; } .discard-choice-button { font-size: 0.8em; padding: 6px 12px; }
    .dice-choice-button { font-size: 1.5em; padding: 8px 15px; min-width: 50px;}
    .modal-content { max-height: 90vh; } #history-log { max-height: 70vh; }
    .card-list-modal-content { padding: 20px 15px; } #card-list-content { max-height: 75vh; font-size: 0.85em;} .card-list-item h3 { font-size: 1.05em; } .card-list-item .card-meta { font-size: 0.7em; }
    .dice-roll-modal-content { max-width: 80vw; width: 80vw; }
    /* 依頼6: スマホでのアナウンス欄アニメーション停止 */
    #current-bet-info { animation: none; border: 1px solid #ffeb3b; box-shadow: inset 0 0 5px rgba(0,0,0,0.2); }
    #message-area { animation: none; border: 1px solid rgba(255, 255, 255, 0.1); }
    #current-bet-info, #message { text-shadow: 1px 1px 2px rgba(0,0,0,0.6); }
    #current-bet-info .parent-name { text-shadow: 1px 1px 2px rgba(0,0,0,0.6); }
}
@media (max-width: 480px) {
    #game-header { padding: 5px 10px; } #game-coin-display { font-size: 1em; } #settings-button { width: 32px; height: 32px; font-size: 1.1em; }
    #game-main-area { padding-top: 42px; } #game-scrollable-area { padding: 5px; padding-bottom: 160px; } #game-container { padding: 10px; max-width: 95%; }
    #wave-info { font-size: 0.9em; } #dice-display { font-size: 3em; } .player-box { padding: 12px; } .player-box p { font-size: 0.9em; }
    #game-area { gap: 8px; } .character-image-area { width: 100px; height: 120px; }
    .center-role { font-size: 3em; padding: 0.1em 0.2em; } .center-role.role-pinzoro { font-size: 3.5em; } .center-role.role-arashi { font-size: 3.3em; } .center-role.role-shigoro { font-size: 3.2em; } .center-role.role-normal-eye { font-size: 3em; } .center-role.role-hifumi { font-size: 3.1em; } .center-role.role-shonben { font-size: 2.8em; } .center-role.result-win { font-size: 4em; } .center-role.result-lose { font-size: 3.5em; } .center-role.result-wave-clear { font-size: 5em; } .center-role.result-game-over { font-size: 4.5em; }
    .parent-marker { font-size: 0.6em; }
    #bottom-control-bar { padding: 8px 8px 10px 8px; } #control-area { gap: 8px; max-width: 100%; }
    .bet-adjust-button { padding: 6px 10px; font-size: 0.9em; min-width: 40px; } #bet-input { padding: 8px; font-size: 1em; } #min-bet-display { font-size: 0.8em; } .bet-action-container button { padding: 8px 14px; font-size: 1em; } .bet-action-container { gap: 8px; }
    button { padding: 8px 15px; font-size: 0.9em; } #start-game-button { padding: 10px 25px; font-size: 1.1em; } #select-character-button { padding: 8px 18px; font-size: 0.9em; } #action-controls { gap: 8px; }
    .shop-outer-container { width: 99%; height: 96%; }
    .shop-header, #shop-scrollable-offers, .shop-footer { padding: 10px; }
    #shop-player-score { font-size: 1em; }
    .shop-content { padding: 15px; max-width: 95%; }
    .card { width: calc(50% - 8px); padding-bottom: 65px; } .card-footer { bottom: 15px; } .card-name { font-size: 1.1em; } .card-description { font-size: 0.85em; } .card-cost { font-size: 1em; } .buy-button { font-size: 0.8em; padding: 5px 10px; }
    #close-shop-button, #reroll-button { font-size: 1em; padding: 8px 20px; }
    #discard-options { gap: 8px; } .discard-choice-button { font-size: 0.8em; padding: 6px 12px; }
    .dice-choice-button { font-size: 1.5em; padding: 8px 15px; min-width: 50px;}
    .character-select-content { padding: 15px 10px; } #character-select-screen h2 { font-size: 1.8em; } #character-preview-image { max-height: 150px; } #character-confirm-area button { padding: 8px 20px; font-size: 0.9em; } #back-to-title-button { padding: 8px 25px; font-size: 0.9em; }
    .modal-content { max-height: 90vh; } #history-log { max-height: 70vh; }
    .card-list-modal-content { padding: 20px 15px; } #card-list-content { max-height: 75vh; font-size: 0.85em;} .card-list-item h3 { font-size: 1.05em; } .card-list-item .card-meta { font-size: 0.7em; }
    .dice-roll-modal-content { max-width: 95vw; width: 95vw; }
}
/* 喜びアニメーション */
@keyframes shake-happy {
    0%, 100% {
      transform: translate(0, 0) rotate(0); /* 開始/終了は元の位置 */
    }
    25% {
      transform: translate(-5px, -8px) rotate(-3deg); /* 左上に移動して少し傾ける */
    }
    50% {
       transform: translate(0, 0) rotate(0); /* 一旦中央に戻る */
    }
    75% {
      transform: translate(5px, -8px) rotate(3deg); /* 右上に移動して反対に傾ける */
    }
  }
  
  /* ダメージアニメーション */
  @keyframes shake-damage {
    0%, 100% { transform: translateX(0); box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5); } /* 通常の影に戻す */
    10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
    20%, 40%, 60%, 80% { transform: translateX(4px); }
    /* 一瞬赤く光る表現 */
    5%, 25%, 45%, 65%, 85% {
        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5), 0 0 15px 5px rgba(255, 0, 0, 0.7);
    }
  }
  
  /* アニメーションを適用するクラス */
  .character-image-area.shake-happy {
    animation: shake-happy 1.5s cubic-bezier(.36,.07,.19,.97) both; /* bothで終了状態維持 */
  }
  
  .character-image-area.shake-damage {
    animation: shake-damage 1s linear both;
  }
  /* ===== 勝敗インジケーター (キャラクターエリア内) ===== */
.win-lose-indicator {
    position: absolute; /* キャラクターエリア基準で配置 */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8); /* 中央配置 & 初期は少し小さく */
    font-size: 4em; /* 文字サイズ (調整可) */
    font-weight: 800;
    font-family: 'RocknRoll One', sans-serif; /* 目立つフォント */
    padding: 10px 20px;
    border-radius: 10px;
    opacity: 0; /* 初期は非表示 */
    pointer-events: none; /* クリックを妨げない */
    z-index: 100; /* 画像より手前 */
    text-align: center;
    white-space: nowrap;
    visibility: hidden;
}

/* WIN スタイルとアニメーション */
.win-lose-indicator.indicator-win {
    color: #ffeb3b; /* 明るい黄色 */
    background-color: rgba(40, 167, 69, 0.7); /* 緑背景 */
    text-shadow: 0 0 5px #fff, 0 0 10px #ffeb3b, 0 0 15px #ffc107;
    border: 2px solid #ffeb3b;
    box-shadow: 0 0 15px rgba(255, 235, 59, 0.7);
    animation: win-appear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    visibility: visible; /* 表示 */
    opacity: 1;
}

@keyframes win-appear {
  0% {
    transform: translate(-50%, -50%) scale(0.5) rotate(-15deg);
    opacity: 0;
  }
  60% {
    transform: translate(-50%, -50%) scale(1.1) rotate(5deg);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(1) rotate(0);
    opacity: 1; /* 表示維持 (JSで消す) */
  }
}

/* LOSE スタイルとアニメーション */
.win-lose-indicator.indicator-lose {
    color: #ff7b7b; /* 暗めの赤 */
    background-color: rgba(139, 0, 0, 0.7); /* 暗赤背景 */
    text-shadow: 0 0 3px #000, 0 0 6px #ff0000;
    border: 2px solid #dc143c;
    box-shadow: 0 0 10px rgba(220, 20, 60, 0.6);
    animation: lose-appear 0.6s ease-out forwards;
    visibility: visible; /* 表示 */
    opacity: 1;
}

@keyframes lose-appear {
   0% {
      transform: translate(-50%, -70%) scale(1.2); /* 上から落ちてくる */
      opacity: 0;
   }
   50% {
       transform: translate(-50%, -48%) scale(0.95); /* 少しバウンド */
       opacity: 1;
   }
   100% {
       transform: translate(-50%, -50%) scale(1); /* 定位置 */
       opacity: 1; /* 表示維持 (JSで消す) */
   }
}

/* ===== END OF style.css ===== */